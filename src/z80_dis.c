/*
 * Copyright 2011-2012,2022 Adrià Giménez Pastor.
 *
 * This file is part of adriagipas/Z80.
 *
 * adriagipas/Z80 is free software: you can redistribute it and/or
 * modify it under the terms of the GNU General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * adriagipas/Z80 is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with adriagipas/Z80.  If not, see <https://www.gnu.org/licenses/>.
 */
/*
 *  z80_dis.c - Implementació de les instruccions de desassemblatge de
 *              codi.
 *
 */


#include <stddef.h>
#include <stdlib.h>

#include "Z80.h"




/**********/
/* MACROS */
/**********/

#define UNK { Z80_UNK, Z80_NONE, Z80_NONE }




/*************/
/* CONSTANTS */
/*************/

static const Z80_InstId _insts_cb[256]=
  {
    /* 0x0 */  { Z80_RLC, Z80_B, Z80_NONE },
    /* 0x1 */  { Z80_RLC, Z80_C, Z80_NONE },
    /* 0x2 */  { Z80_RLC, Z80_D, Z80_NONE },
    /* 0x3 */  { Z80_RLC, Z80_E, Z80_NONE },
    /* 0x4 */  { Z80_RLC, Z80_H, Z80_NONE },
    /* 0x5 */  { Z80_RLC, Z80_L, Z80_NONE },
    /* 0x6 */  { Z80_RLC, Z80_pHL, Z80_NONE },
    /* 0x7 */  { Z80_RLC, Z80_A, Z80_NONE },
    /* 0x8 */  { Z80_RRC, Z80_B, Z80_NONE },
    /* 0x9 */  { Z80_RRC, Z80_C, Z80_NONE },
    /* 0xa */  { Z80_RRC, Z80_D, Z80_NONE },
    /* 0xb */  { Z80_RRC, Z80_E, Z80_NONE },
    /* 0xc */  { Z80_RRC, Z80_H, Z80_NONE },
    /* 0xd */  { Z80_RRC, Z80_L, Z80_NONE },
    /* 0xe */  { Z80_RRC, Z80_pHL, Z80_NONE },
    /* 0xf */  { Z80_RRC, Z80_A, Z80_NONE },
    /* 0x10 */ { Z80_RL, Z80_B, Z80_NONE },
    /* 0x11 */ { Z80_RL, Z80_C, Z80_NONE },
    /* 0x12 */ { Z80_RL, Z80_D, Z80_NONE },
    /* 0x13 */ { Z80_RL, Z80_E, Z80_NONE },
    /* 0x14 */ { Z80_RL, Z80_H, Z80_NONE },
    /* 0x15 */ { Z80_RL, Z80_L, Z80_NONE },
    /* 0x16 */ { Z80_RL, Z80_pHL, Z80_NONE },
    /* 0x17 */ { Z80_RL, Z80_A, Z80_NONE },
    /* 0x18 */ { Z80_RR, Z80_B, Z80_NONE },
    /* 0x19 */ { Z80_RR, Z80_C, Z80_NONE },
    /* 0x1a */ { Z80_RR, Z80_D, Z80_NONE },
    /* 0x1b */ { Z80_RR, Z80_E, Z80_NONE },
    /* 0x1c */ { Z80_RR, Z80_H, Z80_NONE },
    /* 0x1d */ { Z80_RR, Z80_L, Z80_NONE },
    /* 0x1e */ { Z80_RR, Z80_pHL, Z80_NONE },
    /* 0x1f */ { Z80_RR, Z80_A, Z80_NONE },
    /* 0x20 */ { Z80_SLA, Z80_B, Z80_NONE },
    /* 0x21 */ { Z80_SLA, Z80_C, Z80_NONE },
    /* 0x22 */ { Z80_SLA, Z80_D, Z80_NONE },
    /* 0x23 */ { Z80_SLA, Z80_E, Z80_NONE },
    /* 0x24 */ { Z80_SLA, Z80_H, Z80_NONE },
    /* 0x25 */ { Z80_SLA, Z80_L, Z80_NONE },
    /* 0x26 */ { Z80_SLA, Z80_pHL, Z80_NONE },
    /* 0x27 */ { Z80_SLA, Z80_A, Z80_NONE },
    /* 0x28 */ { Z80_SRA, Z80_B, Z80_NONE },
    /* 0x29 */ { Z80_SRA, Z80_C, Z80_NONE },
    /* 0x2a */ { Z80_SRA, Z80_D, Z80_NONE },
    /* 0x2b */ { Z80_SRA, Z80_E, Z80_NONE },
    /* 0x2c */ { Z80_SRA, Z80_H, Z80_NONE },
    /* 0x2d */ { Z80_SRA, Z80_L, Z80_NONE },
    /* 0x2e */ { Z80_SRA, Z80_pHL, Z80_NONE },
    /* 0x2f */ { Z80_SRA, Z80_A, Z80_NONE },
    /* 0x30 */ UNK,
    /* 0x31 */ UNK,
    /* 0x32 */ UNK,
    /* 0x33 */ UNK,
    /* 0x34 */ UNK,
    /* 0x35 */ UNK,
    /* 0x36 */ UNK,
    /* 0x37 */ UNK,
    /* 0x38 */ { Z80_SRL, Z80_B, Z80_NONE },
    /* 0x39 */ { Z80_SRL, Z80_C, Z80_NONE },
    /* 0x3a */ { Z80_SRL, Z80_D, Z80_NONE },
    /* 0x3b */ { Z80_SRL, Z80_E, Z80_NONE },
    /* 0x3c */ { Z80_SRL, Z80_H, Z80_NONE },
    /* 0x3d */ { Z80_SRL, Z80_L, Z80_NONE },
    /* 0x3e */ { Z80_SRL, Z80_pHL, Z80_NONE },
    /* 0x3f */ { Z80_SRL, Z80_A, Z80_NONE },
    /* 0x40 */ { Z80_BIT, Z80_B0, Z80_B },
    /* 0x41 */ { Z80_BIT, Z80_B0, Z80_C },
    /* 0x42 */ { Z80_BIT, Z80_B0, Z80_D },
    /* 0x43 */ { Z80_BIT, Z80_B0, Z80_E },
    /* 0x44 */ { Z80_BIT, Z80_B0, Z80_H },
    /* 0x45 */ { Z80_BIT, Z80_B0, Z80_L },
    /* 0x46 */ { Z80_BIT, Z80_B0, Z80_pHL },
    /* 0x47 */ { Z80_BIT, Z80_B0, Z80_A },
    /* 0x48 */ { Z80_BIT, Z80_B1, Z80_B },
    /* 0x49 */ { Z80_BIT, Z80_B1, Z80_C },
    /* 0x4a */ { Z80_BIT, Z80_B1, Z80_D },
    /* 0x4b */ { Z80_BIT, Z80_B1, Z80_E },
    /* 0x4c */ { Z80_BIT, Z80_B1, Z80_H },
    /* 0x4d */ { Z80_BIT, Z80_B1, Z80_L },
    /* 0x4e */ { Z80_BIT, Z80_B1, Z80_pHL },
    /* 0x4f */ { Z80_BIT, Z80_B1, Z80_A },
    /* 0x50 */ { Z80_BIT, Z80_B2, Z80_B },
    /* 0x51 */ { Z80_BIT, Z80_B2, Z80_C },
    /* 0x52 */ { Z80_BIT, Z80_B2, Z80_D },
    /* 0x53 */ { Z80_BIT, Z80_B2, Z80_E },
    /* 0x54 */ { Z80_BIT, Z80_B2, Z80_H },
    /* 0x55 */ { Z80_BIT, Z80_B2, Z80_L },
    /* 0x56 */ { Z80_BIT, Z80_B2, Z80_pHL },
    /* 0x57 */ { Z80_BIT, Z80_B2, Z80_A },
    /* 0x58 */ { Z80_BIT, Z80_B3, Z80_B },
    /* 0x59 */ { Z80_BIT, Z80_B3, Z80_C },
    /* 0x5a */ { Z80_BIT, Z80_B3, Z80_D },
    /* 0x5b */ { Z80_BIT, Z80_B3, Z80_E },
    /* 0x5c */ { Z80_BIT, Z80_B3, Z80_H },
    /* 0x5d */ { Z80_BIT, Z80_B3, Z80_L },
    /* 0x5e */ { Z80_BIT, Z80_B3, Z80_pHL },
    /* 0x5f */ { Z80_BIT, Z80_B3, Z80_A },
    /* 0x60 */ { Z80_BIT, Z80_B4, Z80_B },
    /* 0x61 */ { Z80_BIT, Z80_B4, Z80_C },
    /* 0x62 */ { Z80_BIT, Z80_B4, Z80_D },
    /* 0x63 */ { Z80_BIT, Z80_B4, Z80_E },
    /* 0x64 */ { Z80_BIT, Z80_B4, Z80_H },
    /* 0x65 */ { Z80_BIT, Z80_B4, Z80_L },
    /* 0x66 */ { Z80_BIT, Z80_B4, Z80_pHL },
    /* 0x67 */ { Z80_BIT, Z80_B4, Z80_A },
    /* 0x68 */ { Z80_BIT, Z80_B5, Z80_B },
    /* 0x69 */ { Z80_BIT, Z80_B5, Z80_C },
    /* 0x6a */ { Z80_BIT, Z80_B5, Z80_D },
    /* 0x6b */ { Z80_BIT, Z80_B5, Z80_E },
    /* 0x6c */ { Z80_BIT, Z80_B5, Z80_H },
    /* 0x6d */ { Z80_BIT, Z80_B5, Z80_L },
    /* 0x6e */ { Z80_BIT, Z80_B5, Z80_pHL },
    /* 0x6f */ { Z80_BIT, Z80_B5, Z80_A },
    /* 0x70 */ { Z80_BIT, Z80_B6, Z80_B },
    /* 0x71 */ { Z80_BIT, Z80_B6, Z80_C },
    /* 0x72 */ { Z80_BIT, Z80_B6, Z80_D },
    /* 0x73 */ { Z80_BIT, Z80_B6, Z80_E },
    /* 0x74 */ { Z80_BIT, Z80_B6, Z80_H },
    /* 0x75 */ { Z80_BIT, Z80_B6, Z80_L },
    /* 0x76 */ { Z80_BIT, Z80_B6, Z80_pHL },
    /* 0x77 */ { Z80_BIT, Z80_B6, Z80_A },
    /* 0x78 */ { Z80_BIT, Z80_B7, Z80_B },
    /* 0x79 */ { Z80_BIT, Z80_B7, Z80_C },
    /* 0x7a */ { Z80_BIT, Z80_B7, Z80_D },
    /* 0x7b */ { Z80_BIT, Z80_B7, Z80_E },
    /* 0x7c */ { Z80_BIT, Z80_B7, Z80_H },
    /* 0x7d */ { Z80_BIT, Z80_B7, Z80_L },
    /* 0x7e */ { Z80_BIT, Z80_B7, Z80_pHL },
    /* 0x7f */ { Z80_BIT, Z80_B7, Z80_A },
    /* 0x80 */ { Z80_RES, Z80_B0, Z80_B },
    /* 0x81 */ { Z80_RES, Z80_B0, Z80_C },
    /* 0x82 */ { Z80_RES, Z80_B0, Z80_D },
    /* 0x83 */ { Z80_RES, Z80_B0, Z80_E },
    /* 0x84 */ { Z80_RES, Z80_B0, Z80_H },
    /* 0x85 */ { Z80_RES, Z80_B0, Z80_L },
    /* 0x86 */ { Z80_RES, Z80_B0, Z80_pHL },
    /* 0x87 */ { Z80_RES, Z80_B0, Z80_A },
    /* 0x88 */ { Z80_RES, Z80_B1, Z80_B },
    /* 0x89 */ { Z80_RES, Z80_B1, Z80_C },
    /* 0x8a */ { Z80_RES, Z80_B1, Z80_D },
    /* 0x8b */ { Z80_RES, Z80_B1, Z80_E },
    /* 0x8c */ { Z80_RES, Z80_B1, Z80_H },
    /* 0x8d */ { Z80_RES, Z80_B1, Z80_L },
    /* 0x8e */ { Z80_RES, Z80_B1, Z80_pHL },
    /* 0x8f */ { Z80_RES, Z80_B1, Z80_A },
    /* 0x90 */ { Z80_RES, Z80_B2, Z80_B },
    /* 0x91 */ { Z80_RES, Z80_B2, Z80_C },
    /* 0x92 */ { Z80_RES, Z80_B2, Z80_D },
    /* 0x93 */ { Z80_RES, Z80_B2, Z80_E },
    /* 0x94 */ { Z80_RES, Z80_B2, Z80_H },
    /* 0x95 */ { Z80_RES, Z80_B2, Z80_L },
    /* 0x96 */ { Z80_RES, Z80_B2, Z80_pHL },
    /* 0x97 */ { Z80_RES, Z80_B2, Z80_A },
    /* 0x98 */ { Z80_RES, Z80_B3, Z80_B },
    /* 0x99 */ { Z80_RES, Z80_B3, Z80_C },
    /* 0x9a */ { Z80_RES, Z80_B3, Z80_D },
    /* 0x9b */ { Z80_RES, Z80_B3, Z80_E },
    /* 0x9c */ { Z80_RES, Z80_B3, Z80_H },
    /* 0x9d */ { Z80_RES, Z80_B3, Z80_L },
    /* 0x9e */ { Z80_RES, Z80_B3, Z80_pHL },
    /* 0x9f */ { Z80_RES, Z80_B3, Z80_A },
    /* 0xa0 */ { Z80_RES, Z80_B4, Z80_B },
    /* 0xa1 */ { Z80_RES, Z80_B4, Z80_C },
    /* 0xa2 */ { Z80_RES, Z80_B4, Z80_D },
    /* 0xa3 */ { Z80_RES, Z80_B4, Z80_E },
    /* 0xa4 */ { Z80_RES, Z80_B4, Z80_H },
    /* 0xa5 */ { Z80_RES, Z80_B4, Z80_L },
    /* 0xa6 */ { Z80_RES, Z80_B4, Z80_pHL },
    /* 0xa7 */ { Z80_RES, Z80_B4, Z80_A },
    /* 0xa8 */ { Z80_RES, Z80_B5, Z80_B },
    /* 0xa9 */ { Z80_RES, Z80_B5, Z80_C },
    /* 0xaa */ { Z80_RES, Z80_B5, Z80_D },
    /* 0xab */ { Z80_RES, Z80_B5, Z80_E },
    /* 0xac */ { Z80_RES, Z80_B5, Z80_H },
    /* 0xad */ { Z80_RES, Z80_B5, Z80_L },
    /* 0xae */ { Z80_RES, Z80_B5, Z80_pHL },
    /* 0xaf */ { Z80_RES, Z80_B5, Z80_A },
    /* 0xb0 */ { Z80_RES, Z80_B6, Z80_B },
    /* 0xb1 */ { Z80_RES, Z80_B6, Z80_C },
    /* 0xb2 */ { Z80_RES, Z80_B6, Z80_D },
    /* 0xb3 */ { Z80_RES, Z80_B6, Z80_E },
    /* 0xb4 */ { Z80_RES, Z80_B6, Z80_H },
    /* 0xb5 */ { Z80_RES, Z80_B6, Z80_L },
    /* 0xb6 */ { Z80_RES, Z80_B6, Z80_pHL },
    /* 0xb7 */ { Z80_RES, Z80_B6, Z80_A },
    /* 0xb8 */ { Z80_RES, Z80_B7, Z80_B },
    /* 0xb9 */ { Z80_RES, Z80_B7, Z80_C },
    /* 0xba */ { Z80_RES, Z80_B7, Z80_D },
    /* 0xbb */ { Z80_RES, Z80_B7, Z80_E },
    /* 0xbc */ { Z80_RES, Z80_B7, Z80_H },
    /* 0xbd */ { Z80_RES, Z80_B7, Z80_L },
    /* 0xbe */ { Z80_RES, Z80_B7, Z80_pHL },
    /* 0xbf */ { Z80_RES, Z80_B7, Z80_A },
    /* 0xc0 */ { Z80_SET, Z80_B0, Z80_B },
    /* 0xc1 */ { Z80_SET, Z80_B0, Z80_C },
    /* 0xc2 */ { Z80_SET, Z80_B0, Z80_D },
    /* 0xc3 */ { Z80_SET, Z80_B0, Z80_E },
    /* 0xc4 */ { Z80_SET, Z80_B0, Z80_H },
    /* 0xc5 */ { Z80_SET, Z80_B0, Z80_L },
    /* 0xc6 */ { Z80_SET, Z80_B0, Z80_pHL },
    /* 0xc7 */ { Z80_SET, Z80_B0, Z80_A },
    /* 0xc8 */ { Z80_SET, Z80_B1, Z80_B },
    /* 0xc9 */ { Z80_SET, Z80_B1, Z80_C },
    /* 0xca */ { Z80_SET, Z80_B1, Z80_D },
    /* 0xcb */ { Z80_SET, Z80_B1, Z80_E },
    /* 0xcc */ { Z80_SET, Z80_B1, Z80_H },
    /* 0xcd */ { Z80_SET, Z80_B1, Z80_L },
    /* 0xce */ { Z80_SET, Z80_B1, Z80_pHL },
    /* 0xcf */ { Z80_SET, Z80_B1, Z80_A },
    /* 0xd0 */ { Z80_SET, Z80_B2, Z80_B },
    /* 0xd1 */ { Z80_SET, Z80_B2, Z80_C },
    /* 0xd2 */ { Z80_SET, Z80_B2, Z80_D },
    /* 0xd3 */ { Z80_SET, Z80_B2, Z80_E },
    /* 0xd4 */ { Z80_SET, Z80_B2, Z80_H },
    /* 0xd5 */ { Z80_SET, Z80_B2, Z80_L },
    /* 0xd6 */ { Z80_SET, Z80_B2, Z80_pHL },
    /* 0xd7 */ { Z80_SET, Z80_B2, Z80_A },
    /* 0xd8 */ { Z80_SET, Z80_B3, Z80_B },
    /* 0xd9 */ { Z80_SET, Z80_B3, Z80_C },
    /* 0xda */ { Z80_SET, Z80_B3, Z80_D },
    /* 0xdb */ { Z80_SET, Z80_B3, Z80_E },
    /* 0xdc */ { Z80_SET, Z80_B3, Z80_H },
    /* 0xdd */ { Z80_SET, Z80_B3, Z80_L },
    /* 0xde */ { Z80_SET, Z80_B3, Z80_pHL },
    /* 0xdf */ { Z80_SET, Z80_B3, Z80_A },
    /* 0xe0 */ { Z80_SET, Z80_B4, Z80_B },
    /* 0xe1 */ { Z80_SET, Z80_B4, Z80_C },
    /* 0xe2 */ { Z80_SET, Z80_B4, Z80_D },
    /* 0xe3 */ { Z80_SET, Z80_B4, Z80_E },
    /* 0xe4 */ { Z80_SET, Z80_B4, Z80_H },
    /* 0xe5 */ { Z80_SET, Z80_B4, Z80_L },
    /* 0xe6 */ { Z80_SET, Z80_B4, Z80_pHL },
    /* 0xe7 */ { Z80_SET, Z80_B4, Z80_A },
    /* 0xe8 */ { Z80_SET, Z80_B5, Z80_B },
    /* 0xe9 */ { Z80_SET, Z80_B5, Z80_C },
    /* 0xea */ { Z80_SET, Z80_B5, Z80_D },
    /* 0xeb */ { Z80_SET, Z80_B5, Z80_E },
    /* 0xec */ { Z80_SET, Z80_B5, Z80_H },
    /* 0xed */ { Z80_SET, Z80_B5, Z80_L },
    /* 0xee */ { Z80_SET, Z80_B5, Z80_pHL },
    /* 0xef */ { Z80_SET, Z80_B5, Z80_A },
    /* 0xf0 */ { Z80_SET, Z80_B6, Z80_B },
    /* 0xf1 */ { Z80_SET, Z80_B6, Z80_C },
    /* 0xf2 */ { Z80_SET, Z80_B6, Z80_D },
    /* 0xf3 */ { Z80_SET, Z80_B6, Z80_E },
    /* 0xf4 */ { Z80_SET, Z80_B6, Z80_H },
    /* 0xf5 */ { Z80_SET, Z80_B6, Z80_L },
    /* 0xf6 */ { Z80_SET, Z80_B6, Z80_pHL },
    /* 0xf7 */ { Z80_SET, Z80_B6, Z80_A },
    /* 0xf8 */ { Z80_SET, Z80_B7, Z80_B },
    /* 0xf9 */ { Z80_SET, Z80_B7, Z80_C },
    /* 0xfa */ { Z80_SET, Z80_B7, Z80_D },
    /* 0xfb */ { Z80_SET, Z80_B7, Z80_E },
    /* 0xfc */ { Z80_SET, Z80_B7, Z80_H },
    /* 0xfd */ { Z80_SET, Z80_B7, Z80_L },
    /* 0xfe */ { Z80_SET, Z80_B7, Z80_pHL },
    /* 0xff */ { Z80_SET, Z80_B7, Z80_A }
  };


static const Z80_InstId _insts_ddcb[256]=
  {
    /* 0x0 */  UNK,
    /* 0x1 */  UNK,
    /* 0x2 */  UNK,
    /* 0x3 */  UNK,
    /* 0x4 */  UNK,
    /* 0x5 */  UNK,
    /* 0x6 */  { Z80_RLC, Z80_pIXd, Z80_NONE },
    /* 0x7 */  UNK,
    /* 0x8 */  UNK,
    /* 0x9 */  UNK,
    /* 0xa */  UNK,
    /* 0xb */  UNK,
    /* 0xc */  UNK,
    /* 0xd */  UNK,
    /* 0xe */  { Z80_RRC, Z80_pIXd, Z80_NONE },
    /* 0xf */  UNK,
    /* 0x10 */ UNK,
    /* 0x11 */ UNK,
    /* 0x12 */ UNK,
    /* 0x13 */ UNK,
    /* 0x14 */ UNK,
    /* 0x15 */ UNK,
    /* 0x16 */ { Z80_RL, Z80_pIXd, Z80_NONE },
    /* 0x17 */ UNK,
    /* 0x18 */ UNK,
    /* 0x19 */ UNK,
    /* 0x1a */ UNK,
    /* 0x1b */ UNK,
    /* 0x1c */ UNK,
    /* 0x1d */ UNK,
    /* 0x1e */ { Z80_RR, Z80_pIXd, Z80_NONE },
    /* 0x1f */ UNK,
    /* 0x20 */ UNK,
    /* 0x21 */ UNK,
    /* 0x22 */ UNK,
    /* 0x23 */ UNK,
    /* 0x24 */ UNK,
    /* 0x25 */ UNK,
    /* 0x26 */ { Z80_SLA, Z80_pIXd, Z80_NONE },
    /* 0x27 */ UNK,
    /* 0x28 */ UNK,
    /* 0x29 */ UNK,
    /* 0x2a */ UNK,
    /* 0x2b */ UNK,
    /* 0x2c */ UNK,
    /* 0x2d */ UNK,
    /* 0x2e */ { Z80_SRA, Z80_pIXd, Z80_NONE },
    /* 0x2f */ UNK,
    /* 0x30 */ UNK,
    /* 0x31 */ UNK,
    /* 0x32 */ UNK,
    /* 0x33 */ UNK,
    /* 0x34 */ UNK,
    /* 0x35 */ UNK,
    /* 0x36 */ UNK,
    /* 0x37 */ UNK,
    /* 0x38 */ UNK,
    /* 0x39 */ UNK,
    /* 0x3a */ UNK,
    /* 0x3b */ UNK,
    /* 0x3c */ UNK,
    /* 0x3d */ UNK,
    /* 0x3e */ { Z80_SRL, Z80_pIXd, Z80_NONE },
    /* 0x3f */ UNK,
    /* 0x40 */ UNK,
    /* 0x41 */ UNK,
    /* 0x42 */ UNK,
    /* 0x43 */ UNK,
    /* 0x44 */ UNK,
    /* 0x45 */ UNK,
    /* 0x46 */ { Z80_BIT, Z80_B0, Z80_pIXd },
    /* 0x47 */ UNK,
    /* 0x48 */ UNK,
    /* 0x49 */ UNK,
    /* 0x4a */ UNK,
    /* 0x4b */ UNK,
    /* 0x4c */ UNK,
    /* 0x4d */ UNK,
    /* 0x4e */ { Z80_BIT, Z80_B1, Z80_pIXd },
    /* 0x4f */ UNK,
    /* 0x50 */ UNK,
    /* 0x51 */ UNK,
    /* 0x52 */ UNK,
    /* 0x53 */ UNK,
    /* 0x54 */ UNK,
    /* 0x55 */ UNK,
    /* 0x56 */ { Z80_BIT, Z80_B2, Z80_pIXd },
    /* 0x57 */ UNK,
    /* 0x58 */ UNK,
    /* 0x59 */ UNK,
    /* 0x5a */ UNK,
    /* 0x5b */ UNK,
    /* 0x5c */ UNK,
    /* 0x5d */ UNK,
    /* 0x5e */ { Z80_BIT, Z80_B3, Z80_pIXd },
    /* 0x5f */ UNK,
    /* 0x60 */ UNK,
    /* 0x61 */ UNK,
    /* 0x62 */ UNK,
    /* 0x63 */ UNK,
    /* 0x64 */ UNK,
    /* 0x65 */ UNK,
    /* 0x66 */ { Z80_BIT, Z80_B4, Z80_pIXd },
    /* 0x67 */ UNK,
    /* 0x68 */ UNK,
    /* 0x69 */ UNK,
    /* 0x6a */ UNK,
    /* 0x6b */ UNK,
    /* 0x6c */ UNK,
    /* 0x6d */ UNK,
    /* 0x6e */ { Z80_BIT, Z80_B5, Z80_pIXd },
    /* 0x6f */ UNK,
    /* 0x70 */ UNK,
    /* 0x71 */ UNK,
    /* 0x72 */ UNK,
    /* 0x73 */ UNK,
    /* 0x74 */ UNK,
    /* 0x75 */ UNK,
    /* 0x76 */ { Z80_BIT, Z80_B6, Z80_pIXd },
    /* 0x77 */ UNK,
    /* 0x78 */ UNK,
    /* 0x79 */ UNK,
    /* 0x7a */ UNK,
    /* 0x7b */ UNK,
    /* 0x7c */ UNK,
    /* 0x7d */ UNK,
    /* 0x7e */ { Z80_BIT, Z80_B7, Z80_pIXd },
    /* 0x7f */ UNK,
    /* 0x80 */ UNK,
    /* 0x81 */ UNK,
    /* 0x82 */ UNK,
    /* 0x83 */ UNK,
    /* 0x84 */ UNK,
    /* 0x85 */ UNK,
    /* 0x86 */ { Z80_RES, Z80_B0, Z80_pIXd },
    /* 0x87 */ UNK,
    /* 0x88 */ UNK,
    /* 0x89 */ UNK,
    /* 0x8a */ UNK,
    /* 0x8b */ UNK,
    /* 0x8c */ UNK,
    /* 0x8d */ UNK,
    /* 0x8e */ { Z80_RES, Z80_B1, Z80_pIXd },
    /* 0x8f */ UNK,
    /* 0x90 */ UNK,
    /* 0x91 */ UNK,
    /* 0x92 */ UNK,
    /* 0x93 */ UNK,
    /* 0x94 */ UNK,
    /* 0x95 */ UNK,
    /* 0x96 */ { Z80_RES, Z80_B2, Z80_pIXd },
    /* 0x97 */ UNK,
    /* 0x98 */ UNK,
    /* 0x99 */ UNK,
    /* 0x9a */ UNK,
    /* 0x9b */ UNK,
    /* 0x9c */ UNK,
    /* 0x9d */ UNK,
    /* 0x9e */ { Z80_RES, Z80_B3, Z80_pIXd },
    /* 0x9f */ UNK,
    /* 0xa0 */ UNK,
    /* 0xa1 */ UNK,
    /* 0xa2 */ UNK,
    /* 0xa3 */ UNK,
    /* 0xa4 */ UNK,
    /* 0xa5 */ UNK,
    /* 0xa6 */ { Z80_RES, Z80_B4, Z80_pIXd },
    /* 0xa7 */ UNK,
    /* 0xa8 */ UNK,
    /* 0xa9 */ UNK,
    /* 0xaa */ UNK,
    /* 0xab */ UNK,
    /* 0xac */ UNK,
    /* 0xad */ UNK,
    /* 0xae */ { Z80_RES, Z80_B5, Z80_pIXd },
    /* 0xaf */ UNK,
    /* 0xb0 */ UNK,
    /* 0xb1 */ UNK,
    /* 0xb2 */ UNK,
    /* 0xb3 */ UNK,
    /* 0xb4 */ UNK,
    /* 0xb5 */ UNK,
    /* 0xb6 */ { Z80_RES, Z80_B6, Z80_pIXd },
    /* 0xb7 */ UNK,
    /* 0xb8 */ UNK,
    /* 0xb9 */ UNK,
    /* 0xba */ UNK,
    /* 0xbb */ UNK,
    /* 0xbc */ UNK,
    /* 0xbd */ UNK,
    /* 0xbe */ { Z80_RES, Z80_B7, Z80_pIXd },
    /* 0xbf */ UNK,
    /* 0xc0 */ UNK,
    /* 0xc1 */ UNK,
    /* 0xc2 */ UNK,
    /* 0xc3 */ UNK,
    /* 0xc4 */ UNK,
    /* 0xc5 */ UNK,
    /* 0xc6 */ { Z80_SET, Z80_B0, Z80_pIXd },
    /* 0xc7 */ UNK,
    /* 0xc8 */ UNK,
    /* 0xc9 */ UNK,
    /* 0xca */ UNK,
    /* 0xcb */ UNK,
    /* 0xcc */ UNK,
    /* 0xcd */ UNK,
    /* 0xce */ { Z80_SET, Z80_B1, Z80_pIXd },
    /* 0xcf */ UNK,
    /* 0xd0 */ UNK,
    /* 0xd1 */ UNK,
    /* 0xd2 */ UNK,
    /* 0xd3 */ UNK,
    /* 0xd4 */ UNK,
    /* 0xd5 */ UNK,
    /* 0xd6 */ { Z80_SET, Z80_B2, Z80_pIXd },
    /* 0xd7 */ UNK,
    /* 0xd8 */ UNK,
    /* 0xd9 */ UNK,
    /* 0xda */ UNK,
    /* 0xdb */ UNK,
    /* 0xdc */ UNK,
    /* 0xdd */ UNK,
    /* 0xde */ { Z80_SET, Z80_B3, Z80_pIXd },
    /* 0xdf */ UNK,
    /* 0xe0 */ UNK,
    /* 0xe1 */ UNK,
    /* 0xe2 */ UNK,
    /* 0xe3 */ UNK,
    /* 0xe4 */ UNK,
    /* 0xe5 */ UNK,
    /* 0xe6 */ { Z80_SET, Z80_B4, Z80_pIXd },
    /* 0xe7 */ UNK,
    /* 0xe8 */ UNK,
    /* 0xe9 */ UNK,
    /* 0xea */ UNK,
    /* 0xeb */ UNK,
    /* 0xec */ UNK,
    /* 0xed */ UNK,
    /* 0xee */ { Z80_SET, Z80_B5, Z80_pIXd },
    /* 0xef */ UNK,
    /* 0xf0 */ UNK,
    /* 0xf1 */ UNK,
    /* 0xf2 */ UNK,
    /* 0xf3 */ UNK,
    /* 0xf4 */ UNK,
    /* 0xf5 */ UNK,
    /* 0xf6 */ { Z80_SET, Z80_B6, Z80_pIXd },
    /* 0xf7 */ UNK,
    /* 0xf8 */ UNK,
    /* 0xf9 */ UNK,
    /* 0xfa */ UNK,
    /* 0xfb */ UNK,
    /* 0xfc */ UNK,
    /* 0xfd */ UNK,
    /* 0xfe */ { Z80_SET, Z80_B7, Z80_pIXd },
    /* 0xff */ UNK  
  };


static const Z80_InstId _insts_dd[256]=
  {
    /* 0x0 */  UNK,
    /* 0x1 */  UNK,
    /* 0x2 */  UNK,
    /* 0x3 */  UNK,
    /* 0x4 */  UNK,
    /* 0x5 */  UNK,
    /* 0x6 */  UNK,
    /* 0x7 */  UNK,
    /* 0x8 */  UNK,
    /* 0x9 */  { Z80_ADD, Z80_IX, Z80_BC },
    /* 0xa */  UNK,
    /* 0xb */  UNK,
    /* 0xc */  UNK,
    /* 0xd */  UNK,
    /* 0xe */  UNK,
    /* 0xf */  UNK,
    /* 0x10 */ UNK,
    /* 0x11 */ UNK,
    /* 0x12 */ UNK,
    /* 0x13 */ UNK,
    /* 0x14 */ UNK,
    /* 0x15 */ UNK,
    /* 0x16 */ UNK,
    /* 0x17 */ UNK,
    /* 0x18 */ UNK,
    /* 0x19 */ { Z80_ADD, Z80_IX, Z80_DE },
    /* 0x1a */ UNK,
    /* 0x1b */ UNK,
    /* 0x1c */ UNK,
    /* 0x1d */ UNK,
    /* 0x1e */ UNK,
    /* 0x1f */ UNK,
    /* 0x20 */ UNK,
    /* 0x21 */ { Z80_LD, Z80_IX, Z80_WORD },
    /* 0x22 */ { Z80_LD, Z80_ADDR, Z80_IX },
    /* 0x23 */ { Z80_INC, Z80_IX, Z80_NONE },
    /* 0x24 */ { Z80_INC, Z80_IXH, Z80_NONE },
    /* 0x25 */ { Z80_DEC, Z80_IXH, Z80_NONE },
    /* 0x26 */ { Z80_LD, Z80_IXH, Z80_BYTE },
    /* 0x27 */ UNK,
    /* 0x28 */ UNK,
    /* 0x29 */ { Z80_ADD, Z80_IX, Z80_IX },
    /* 0x2a */ { Z80_LD, Z80_IX, Z80_ADDR },
    /* 0x2b */ { Z80_DEC, Z80_IX, Z80_NONE },
    /* 0x2c */ { Z80_INC, Z80_IXL, Z80_NONE },
    /* 0x2d */ { Z80_DEC, Z80_IXL, Z80_NONE },
    /* 0x2e */ { Z80_LD, Z80_IXL, Z80_BYTE },
    /* 0x2f */ UNK,
    /* 0x30 */ UNK,
    /* 0x31 */ UNK,
    /* 0x32 */ UNK,
    /* 0x33 */ UNK,
    /* 0x34 */ { Z80_INC, Z80_pIXd, Z80_NONE },
    /* 0x35 */ { Z80_DEC, Z80_pIXd, Z80_NONE },
    /* 0x36 */ { Z80_LD, Z80_pIXd, Z80_BYTE },
    /* 0x37 */ UNK,
    /* 0x38 */ UNK,
    /* 0x39 */ { Z80_ADD, Z80_IX, Z80_SP },
    /* 0x3a */ UNK,
    /* 0x3b */ UNK,
    /* 0x3c */ UNK,
    /* 0x3d */ UNK,
    /* 0x3e */ UNK,
    /* 0x3f */ UNK,
    /* 0x40 */ UNK,
    /* 0x41 */ UNK,
    /* 0x42 */ UNK,
    /* 0x43 */ UNK,
    /* 0x44 */ { Z80_LD, Z80_B, Z80_IXH },
    /* 0x45 */ { Z80_LD, Z80_B, Z80_IXL },
    /* 0x46 */ { Z80_LD, Z80_B, Z80_pIXd },
    /* 0x47 */ UNK,
    /* 0x48 */ UNK,
    /* 0x49 */ { Z80_ADD, Z80_IX, Z80_BC },
    /* 0x4a */ UNK,
    /* 0x4b */ UNK,
    /* 0x4c */ { Z80_LD, Z80_C, Z80_IXH },
    /* 0x4d */ { Z80_LD, Z80_C, Z80_IXL },
    /* 0x4e */ { Z80_LD, Z80_C, Z80_pIXd },
    /* 0x4f */ UNK,
    /* 0x50 */ UNK,
    /* 0x51 */ UNK,
    /* 0x52 */ UNK,
    /* 0x53 */ UNK,
    /* 0x54 */ { Z80_LD, Z80_D, Z80_IXH },
    /* 0x55 */ { Z80_LD, Z80_D, Z80_IXL },
    /* 0x56 */ { Z80_LD, Z80_D, Z80_pIXd },
    /* 0x57 */ UNK,
    /* 0x58 */ UNK,
    /* 0x59 */ { Z80_ADD, Z80_IX, Z80_DE },
    /* 0x5a */ UNK,
    /* 0x5b */ UNK,
    /* 0x5c */ { Z80_LD, Z80_E, Z80_IXH },
    /* 0x5d */ { Z80_LD, Z80_E, Z80_IXL },
    /* 0x5e */ { Z80_LD, Z80_E, Z80_pIXd },
    /* 0x5f */ UNK,
    /* 0x60 */ { Z80_LD, Z80_IXH, Z80_B },
    /* 0x61 */ { Z80_LD, Z80_IXH, Z80_C },
    /* 0x62 */ { Z80_LD, Z80_IXH, Z80_D },
    /* 0x63 */ { Z80_LD, Z80_IXH, Z80_E },
    /* 0x64 */ UNK,
    /* 0x65 */ UNK,
    /* 0x66 */ { Z80_LD, Z80_H, Z80_pIXd },
    /* 0x67 */ { Z80_LD, Z80_IXH, Z80_A },
    /* 0x68 */ { Z80_LD, Z80_IXL, Z80_B },
    /* 0x69 */ { Z80_LD, Z80_IXL, Z80_C },
    /* 0x6a */ { Z80_LD, Z80_IXL, Z80_D },
    /* 0x6b */ { Z80_LD, Z80_IXL, Z80_E },
    /* 0x6c */ UNK,
    /* 0x6d */ UNK,
    /* 0x6e */ { Z80_LD, Z80_L, Z80_pIXd },
    /* 0x6f */ { Z80_LD, Z80_IXL, Z80_A },
    /* 0x70 */ { Z80_LD, Z80_pIXd, Z80_B },
    /* 0x71 */ { Z80_LD, Z80_pIXd, Z80_C },
    /* 0x72 */ { Z80_LD, Z80_pIXd, Z80_D },
    /* 0x73 */ { Z80_LD, Z80_pIXd, Z80_E },
    /* 0x74 */ { Z80_LD, Z80_pIXd, Z80_H },
    /* 0x75 */ { Z80_LD, Z80_pIXd, Z80_L },
    /* 0x76 */ UNK,
    /* 0x77 */ { Z80_LD, Z80_pIXd, Z80_A },
    /* 0x78 */ UNK,
    /* 0x79 */ { Z80_ADD, Z80_IX, Z80_SP },
    /* 0x7a */ UNK,
    /* 0x7b */ UNK,
    /* 0x7c */ { Z80_LD, Z80_A, Z80_IXH },
    /* 0x7d */ { Z80_LD, Z80_A, Z80_IXL },
    /* 0x7e */ { Z80_LD, Z80_A, Z80_pIXd },
    /* 0x7f */ UNK,
    /* 0x80 */ UNK,
    /* 0x81 */ UNK,
    /* 0x82 */ UNK,
    /* 0x83 */ UNK,
    /* 0x84 */ UNK,
    /* 0x85 */ { Z80_ADD, Z80_A, Z80_IXL },
    /* 0x86 */ { Z80_ADD, Z80_A, Z80_pIXd },
    /* 0x87 */ UNK,
    /* 0x88 */ UNK,
    /* 0x89 */ UNK,
    /* 0x8a */ UNK,
    /* 0x8b */ UNK,
    /* 0x8c */ { Z80_ADC, Z80_A, Z80_IXH },
    /* 0x8d */ UNK,
    /* 0x8e */ { Z80_ADC, Z80_A, Z80_pIXd },
    /* 0x8f */ UNK,
    /* 0x90 */ UNK,
    /* 0x91 */ UNK,
    /* 0x92 */ UNK,
    /* 0x93 */ UNK,
    /* 0x94 */ { Z80_SUB, Z80_A, Z80_IXH },
    /* 0x95 */ { Z80_SUB, Z80_A, Z80_IXL },
    /* 0x96 */ { Z80_SUB, Z80_A, Z80_pIXd },
    /* 0x97 */ UNK,
    /* 0x98 */ UNK,
    /* 0x99 */ UNK,
    /* 0x9a */ UNK,
    /* 0x9b */ UNK,
    /* 0x9c */ UNK,
    /* 0x9d */ UNK,
    /* 0x9e */ { Z80_SBC, Z80_A, Z80_pIXd },
    /* 0x9f */ UNK,
    /* 0xa0 */ UNK,
    /* 0xa1 */ UNK,
    /* 0xa2 */ UNK,
    /* 0xa3 */ UNK,
    /* 0xa4 */ UNK,
    /* 0xa5 */ UNK,
    /* 0xa6 */ { Z80_AND, Z80_A, Z80_pIXd },
    /* 0xa7 */ UNK,
    /* 0xa8 */ UNK,
    /* 0xa9 */ UNK,
    /* 0xaa */ UNK,
    /* 0xab */ UNK,
    /* 0xac */ UNK,
    /* 0xad */ UNK,
    /* 0xae */ { Z80_XOR, Z80_A, Z80_pIXd },
    /* 0xaf */ UNK,
    /* 0xb0 */ UNK,
    /* 0xb1 */ UNK,
    /* 0xb2 */ UNK,
    /* 0xb3 */ UNK,
    /* 0xb4 */ { Z80_OR, Z80_A, Z80_IXH },
    /* 0xb5 */ { Z80_OR, Z80_A, Z80_IXL },
    /* 0xb6 */ { Z80_OR, Z80_A, Z80_pIXd },
    /* 0xb7 */ UNK,
    /* 0xb8 */ UNK,
    /* 0xb9 */ UNK,
    /* 0xba */ UNK,
    /* 0xbb */ UNK,
    /* 0xbc */ { Z80_CP, Z80_A, Z80_IXH },
    /* 0xbd */ { Z80_CP, Z80_A, Z80_IXL },
    /* 0xbe */ { Z80_CP, Z80_A, Z80_pIXd },
    /* 0xbf */ UNK,
    /* 0xc0 */ UNK,
    /* 0xc1 */ UNK,
    /* 0xc2 */ UNK,
    /* 0xc3 */ UNK,
    /* 0xc4 */ UNK,
    /* 0xc5 */ UNK,
    /* 0xc6 */ UNK,
    /* 0xc7 */ UNK,
    /* 0xc8 */ UNK,
    /* 0xc9 */ UNK,
    /* 0xca */ UNK,
    /* 0xcb */ UNK,
    /* 0xcc */ UNK,
    /* 0xcd */ UNK,
    /* 0xce */ UNK,
    /* 0xcf */ UNK,
    /* 0xd0 */ UNK,
    /* 0xd1 */ UNK,
    /* 0xd2 */ UNK,
    /* 0xd3 */ UNK,
    /* 0xd4 */ UNK,
    /* 0xd5 */ UNK,
    /* 0xd6 */ UNK,
    /* 0xd7 */ UNK,
    /* 0xd8 */ UNK,
    /* 0xd9 */ UNK,
    /* 0xda */ UNK,
    /* 0xdb */ UNK,
    /* 0xdc */ UNK,
    /* 0xdd */ UNK,
    /* 0xde */ UNK,
    /* 0xdf */ UNK,
    /* 0xe0 */ UNK,
    /* 0xe1 */ { Z80_POP, Z80_IX, Z80_NONE },
    /* 0xe2 */ UNK,
    /* 0xe3 */ { Z80_EX, Z80_pSP, Z80_IX },
    /* 0xe4 */ UNK,
    /* 0xe5 */ { Z80_PUSH, Z80_IX, Z80_NONE },
    /* 0xe6 */ UNK,
    /* 0xe7 */ UNK,
    /* 0xe8 */ UNK,
    /* 0xe9 */ { Z80_JP, Z80_pIX, Z80_NONE },
    /* 0xea */ UNK,
    /* 0xeb */ UNK,
    /* 0xec */ UNK,
    /* 0xed */ UNK,
    /* 0xee */ UNK,
    /* 0xef */ UNK,
    /* 0xf0 */ UNK,
    /* 0xf1 */ UNK,
    /* 0xf2 */ UNK,
    /* 0xf3 */ UNK,
    /* 0xf4 */ UNK,
    /* 0xf5 */ UNK,
    /* 0xf6 */ UNK,
    /* 0xf7 */ UNK,
    /* 0xf8 */ UNK,
    /* 0xf9 */ { Z80_LD, Z80_SP, Z80_IX },
    /* 0xfa */ UNK,
    /* 0xfb */ UNK,
    /* 0xfc */ UNK,
    /* 0xfd */ UNK,
    /* 0xfe */ UNK,
    /* 0xff */ UNK  
  };


static const Z80_InstId _insts_ed[256]=
  {
    /* 0x0 */  UNK,
    /* 0x1 */  UNK,
    /* 0x2 */  UNK,
    /* 0x3 */  UNK,
    /* 0x4 */  UNK,
    /* 0x5 */  UNK,
    /* 0x6 */  UNK,
    /* 0x7 */  UNK,
    /* 0x8 */  UNK,
    /* 0x9 */  UNK,
    /* 0xa */  UNK,
    /* 0xb */  UNK,
    /* 0xc */  UNK,
    /* 0xd */  UNK,
    /* 0xe */  UNK,
    /* 0xf */  UNK,
    /* 0x10 */ UNK,
    /* 0x11 */ UNK,
    /* 0x12 */ UNK,
    /* 0x13 */ UNK,
    /* 0x14 */ UNK,
    /* 0x15 */ UNK,
    /* 0x16 */ UNK,
    /* 0x17 */ UNK,
    /* 0x18 */ UNK,
    /* 0x19 */ UNK,
    /* 0x1a */ UNK,
    /* 0x1b */ UNK,
    /* 0x1c */ UNK,
    /* 0x1d */ UNK,
    /* 0x1e */ UNK,
    /* 0x1f */ UNK,
    /* 0x20 */ UNK,
    /* 0x21 */ UNK,
    /* 0x22 */ UNK,
    /* 0x23 */ UNK,
    /* 0x24 */ UNK,
    /* 0x25 */ UNK,
    /* 0x26 */ UNK,
    /* 0x27 */ UNK,
    /* 0x28 */ UNK,
    /* 0x29 */ UNK,
    /* 0x2a */ UNK,
    /* 0x2b */ UNK,
    /* 0x2c */ UNK,
    /* 0x2d */ UNK,
    /* 0x2e */ UNK,
    /* 0x2f */ UNK,
    /* 0x30 */ UNK,
    /* 0x31 */ UNK,
    /* 0x32 */ UNK,
    /* 0x33 */ UNK,
    /* 0x34 */ UNK,
    /* 0x35 */ UNK,
    /* 0x36 */ UNK,
    /* 0x37 */ UNK,
    /* 0x38 */ UNK,
    /* 0x39 */ UNK,
    /* 0x3a */ UNK,
    /* 0x3b */ UNK,
    /* 0x3c */ UNK,
    /* 0x3d */ UNK,
    /* 0x3e */ UNK,
    /* 0x3f */ UNK,
    /* 0x40 */ { Z80_IN, Z80_B, Z80_pC },
    /* 0x41 */ { Z80_OUT, Z80_pC, Z80_B },
    /* 0x42 */ { Z80_SBC, Z80_HL, Z80_BC },
    /* 0x43 */ { Z80_LD, Z80_ADDR, Z80_BC },
    /* 0x44 */ { Z80_NEG, Z80_NONE, Z80_NONE },
    /* 0x45 */ { Z80_RETN, Z80_NONE, Z80_NONE },
    /* 0x46 */ { Z80_IM0, Z80_NONE, Z80_NONE },
    /* 0x47 */ { Z80_LD, Z80_I, Z80_A },
    /* 0x48 */ { Z80_IN, Z80_C, Z80_pC },
    /* 0x49 */ { Z80_OUT, Z80_pC, Z80_C },
    /* 0x4a */ { Z80_ADC, Z80_HL, Z80_BC },
    /* 0x4b */ { Z80_LD, Z80_BC, Z80_ADDR },
    /* 0x4c */ UNK,
    /* 0x4d */ { Z80_RETI, Z80_NONE, Z80_NONE },
    /* 0x4e */ UNK,
    /* 0x4f */ { Z80_LD, Z80_R, Z80_A },
    /* 0x50 */ { Z80_IN, Z80_D, Z80_pC },
    /* 0x51 */ { Z80_OUT, Z80_pC, Z80_D },
    /* 0x52 */ { Z80_SBC, Z80_HL, Z80_DE },
    /* 0x53 */ { Z80_LD, Z80_ADDR, Z80_DE }, /* Und. Réplica de 0x13. */
    /* 0x54 */ UNK,
    /* 0x55 */ UNK,
    /* 0x56 */ { Z80_IM1, Z80_NONE, Z80_NONE },
    /* 0x57 */ { Z80_LD, Z80_A, Z80_I },
    /* 0x58 */ { Z80_IN, Z80_E, Z80_pC },
    /* 0x59 */ { Z80_OUT, Z80_pC, Z80_E },
    /* 0x5a */ { Z80_ADC, Z80_HL, Z80_DE },
    /* 0x5b */ { Z80_LD, Z80_DE, Z80_ADDR },
    /* 0x5c */ UNK,
    /* 0x5d */ UNK,
    /* 0x5e */ { Z80_IM2, Z80_NONE, Z80_NONE },
    /* 0x5f */ { Z80_LD, Z80_A, Z80_R },
    /* 0x60 */ { Z80_IN, Z80_H, Z80_pC },
    /* 0x61 */ { Z80_OUT, Z80_pC, Z80_H },
    /* 0x62 */ { Z80_SBC, Z80_HL, Z80_HL },
    /* 0x63 */ { Z80_LD, Z80_ADDR, Z80_HL },
    /* 0x64 */ UNK,
    /* 0x65 */ UNK,
    /* 0x66 */ UNK,
    /* 0x67 */ { Z80_RRD, Z80_NONE, Z80_NONE },
    /* 0x68 */ { Z80_IN, Z80_L, Z80_pC },
    /* 0x69 */ { Z80_OUT, Z80_pC, Z80_L },
    /* 0x6a */ { Z80_ADC, Z80_HL, Z80_HL },
    /* 0x6b */ { Z80_LD, Z80_HL, Z80_ADDR },
    /* 0x6c */ UNK,
    /* 0x6d */ UNK,
    /* 0x6e */ UNK,
    /* 0x6f */ { Z80_RLD, Z80_NONE, Z80_NONE },
    /* 0x70 */ { Z80_IN, Z80_pC, Z80_NONE },
    /* 0x71 */ UNK,
    /* 0x72 */ { Z80_SBC, Z80_HL, Z80_SP },
    /* 0x73 */ { Z80_LD, Z80_ADDR, Z80_SP },
    /* 0x74 */ UNK,
    /* 0x75 */ UNK,
    /* 0x76 */ UNK,
    /* 0x77 */ UNK,
    /* 0x78 */ { Z80_IN, Z80_A, Z80_pC },
    /* 0x79 */ { Z80_OUT, Z80_pC, Z80_A },
    /* 0x7a */ { Z80_ADC, Z80_HL, Z80_SP },
    /* 0x7b */ { Z80_LD, Z80_SP, Z80_ADDR },
    /* 0x7c */ UNK,
    /* 0x7d */ UNK,
    /* 0x7e */ UNK,
    /* 0x7f */ UNK,
    /* 0x80 */ UNK,
    /* 0x81 */ UNK,
    /* 0x82 */ UNK,
    /* 0x83 */ UNK,
    /* 0x84 */ UNK,
    /* 0x85 */ UNK,
    /* 0x86 */ UNK,
    /* 0x87 */ UNK,
    /* 0x88 */ UNK,
    /* 0x89 */ UNK,
    /* 0x8a */ UNK,
    /* 0x8b */ UNK,
    /* 0x8c */ UNK,
    /* 0x8d */ UNK,
    /* 0x8e */ UNK,
    /* 0x8f */ UNK,
    /* 0x90 */ UNK,
    /* 0x91 */ UNK,
    /* 0x92 */ UNK,
    /* 0x93 */ UNK,
    /* 0x94 */ UNK,
    /* 0x95 */ UNK,
    /* 0x96 */ UNK,
    /* 0x97 */ UNK,
    /* 0x98 */ UNK,
    /* 0x99 */ UNK,
    /* 0x9a */ UNK,
    /* 0x9b */ UNK,
    /* 0x9c */ UNK,
    /* 0x9d */ UNK,
    /* 0x9e */ UNK,
    /* 0x9f */ UNK,
    /* 0xa0 */ { Z80_LDI, Z80_NONE, Z80_NONE },
    /* 0xa1 */ { Z80_CPI, Z80_NONE, Z80_NONE },
    /* 0xa2 */ { Z80_INI, Z80_NONE, Z80_NONE },
    /* 0xa3 */ { Z80_OUTI, Z80_NONE, Z80_NONE },
    /* 0xa4 */ UNK,
    /* 0xa5 */ UNK,
    /* 0xa6 */ UNK,
    /* 0xa7 */ UNK,
    /* 0xa8 */ { Z80_LDD, Z80_NONE, Z80_NONE },
    /* 0xa9 */ { Z80_CPD, Z80_NONE, Z80_NONE },
    /* 0xaa */ { Z80_IND, Z80_NONE, Z80_NONE },
    /* 0xab */ { Z80_OUTD, Z80_NONE, Z80_NONE },
    /* 0xac */ UNK,
    /* 0xad */ UNK,
    /* 0xae */ UNK,
    /* 0xaf */ UNK,
    /* 0xb0 */ { Z80_LDIR, Z80_NONE, Z80_NONE },
    /* 0xb1 */ { Z80_CPIR, Z80_NONE, Z80_NONE },
    /* 0xb2 */ { Z80_INIR, Z80_NONE, Z80_NONE },
    /* 0xb3 */ { Z80_OTIR, Z80_NONE, Z80_NONE },
    /* 0xb4 */ UNK,
    /* 0xb5 */ UNK,
    /* 0xb6 */ UNK,
    /* 0xb7 */ UNK,
    /* 0xb8 */ { Z80_LDDR, Z80_NONE, Z80_NONE },
    /* 0xb9 */ { Z80_CPDR, Z80_NONE, Z80_NONE },
    /* 0xba */ { Z80_INDR, Z80_NONE, Z80_NONE },
    /* 0xbb */ { Z80_OTDR, Z80_NONE, Z80_NONE },
    /* 0xbc */ UNK,
    /* 0xbd */ UNK,
    /* 0xbe */ UNK,
    /* 0xbf */ UNK,
    /* 0xc0 */ UNK,
    /* 0xc1 */ UNK,
    /* 0xc2 */ UNK,
    /* 0xc3 */ UNK,
    /* 0xc4 */ UNK,
    /* 0xc5 */ UNK,
    /* 0xc6 */ UNK,
    /* 0xc7 */ UNK,
    /* 0xc8 */ UNK,
    /* 0xc9 */ UNK,
    /* 0xca */ UNK,
    /* 0xcb */ UNK,
    /* 0xcc */ UNK,
    /* 0xcd */ UNK,
    /* 0xce */ UNK,
    /* 0xcf */ UNK,
    /* 0xd0 */ UNK,
    /* 0xd1 */ UNK,
    /* 0xd2 */ UNK,
    /* 0xd3 */ UNK,
    /* 0xd4 */ UNK,
    /* 0xd5 */ UNK,
    /* 0xd6 */ UNK,
    /* 0xd7 */ UNK,
    /* 0xd8 */ UNK,
    /* 0xd9 */ UNK,
    /* 0xda */ UNK,
    /* 0xdb */ UNK,
    /* 0xdc */ UNK,
    /* 0xdd */ UNK,
    /* 0xde */ UNK,
    /* 0xdf */ UNK,
    /* 0xe0 */ UNK,
    /* 0xe1 */ UNK,
    /* 0xe2 */ UNK,
    /* 0xe3 */ UNK,
    /* 0xe4 */ UNK,
    /* 0xe5 */ UNK,
    /* 0xe6 */ UNK,
    /* 0xe7 */ UNK,
    /* 0xe8 */ UNK,
    /* 0xe9 */ UNK,
    /* 0xea */ UNK,
    /* 0xeb */ UNK,
    /* 0xec */ UNK,
    /* 0xed */ UNK,
    /* 0xee */ UNK,
    /* 0xef */ UNK,
    /* 0xf0 */ UNK,
    /* 0xf1 */ UNK,
    /* 0xf2 */ UNK,
    /* 0xf3 */ UNK,
    /* 0xf4 */ UNK,
    /* 0xf5 */ UNK,
    /* 0xf6 */ UNK,
    /* 0xf7 */ UNK,
    /* 0xf8 */ UNK,
    /* 0xf9 */ UNK,
    /* 0xfa */ UNK,
    /* 0xfb */ UNK,
    /* 0xfc */ UNK,
    /* 0xfd */ UNK,
    /* 0xfe */ UNK,
    /* 0xff */ UNK  
  };


static const Z80_InstId _insts_fdcb[256]=
  {
    /* 0x0 */  UNK,
    /* 0x1 */  UNK,
    /* 0x2 */  UNK,
    /* 0x3 */  UNK,
    /* 0x4 */  UNK,
    /* 0x5 */  UNK,
    /* 0x6 */  { Z80_RLC, Z80_pIYd, Z80_NONE },
    /* 0x7 */  UNK,
    /* 0x8 */  UNK,
    /* 0x9 */  UNK,
    /* 0xa */  UNK,
    /* 0xb */  UNK,
    /* 0xc */  UNK,
    /* 0xd */  UNK,
    /* 0xe */  { Z80_RRC, Z80_pIYd, Z80_NONE },
    /* 0xf */  UNK,
    /* 0x10 */ UNK,
    /* 0x11 */ UNK,
    /* 0x12 */ UNK,
    /* 0x13 */ UNK,
    /* 0x14 */ UNK,
    /* 0x15 */ UNK,
    /* 0x16 */ { Z80_RL, Z80_pIYd, Z80_NONE },
    /* 0x17 */ UNK,
    /* 0x18 */ UNK,
    /* 0x19 */ UNK,
    /* 0x1a */ UNK,
    /* 0x1b */ UNK,
    /* 0x1c */ UNK,
    /* 0x1d */ UNK,
    /* 0x1e */ { Z80_RR, Z80_pIYd, Z80_NONE },
    /* 0x1f */ UNK,
    /* 0x20 */ UNK,
    /* 0x21 */ UNK,
    /* 0x22 */ UNK,
    /* 0x23 */ UNK,
    /* 0x24 */ UNK,
    /* 0x25 */ UNK,
    /* 0x26 */ { Z80_SLA, Z80_pIYd, Z80_NONE },
    /* 0x27 */ UNK,
    /* 0x28 */ UNK,
    /* 0x29 */ UNK,
    /* 0x2a */ UNK,
    /* 0x2b */ UNK,
    /* 0x2c */ UNK,
    /* 0x2d */ UNK,
    /* 0x2e */ { Z80_SRA, Z80_pIYd, Z80_NONE },
    /* 0x2f */ UNK,
    /* 0x30 */ UNK,
    /* 0x31 */ UNK,
    /* 0x32 */ UNK,
    /* 0x33 */ UNK,
    /* 0x34 */ UNK,
    /* 0x35 */ UNK,
    /* 0x36 */ UNK,
    /* 0x37 */ UNK,
    /* 0x38 */ UNK,
    /* 0x39 */ UNK,
    /* 0x3a */ UNK,
    /* 0x3b */ UNK,
    /* 0x3c */ UNK,
    /* 0x3d */ UNK,
    /* 0x3e */ { Z80_SRL, Z80_pIYd, Z80_NONE },
    /* 0x3f */ UNK,
    /* 0x40 */ UNK,
    /* 0x41 */ UNK,
    /* 0x42 */ UNK,
    /* 0x43 */ UNK,
    /* 0x44 */ UNK,
    /* 0x45 */ UNK,
    /* 0x46 */ { Z80_BIT, Z80_B0, Z80_pIYd },
    /* 0x47 */ UNK,
    /* 0x48 */ UNK,
    /* 0x49 */ UNK,
    /* 0x4a */ UNK,
    /* 0x4b */ UNK,
    /* 0x4c */ UNK,
    /* 0x4d */ UNK,
    /* 0x4e */ { Z80_BIT, Z80_B1, Z80_pIYd },
    /* 0x4f */ UNK,
    /* 0x50 */ UNK,
    /* 0x51 */ UNK,
    /* 0x52 */ UNK,
    /* 0x53 */ UNK,
    /* 0x54 */ UNK,
    /* 0x55 */ UNK,
    /* 0x56 */ { Z80_BIT, Z80_B2, Z80_pIYd },
    /* 0x57 */ UNK,
    /* 0x58 */ UNK,
    /* 0x59 */ UNK,
    /* 0x5a */ UNK,
    /* 0x5b */ UNK,
    /* 0x5c */ UNK,
    /* 0x5d */ UNK,
    /* 0x5e */ { Z80_BIT, Z80_B3, Z80_pIYd },
    /* 0x5f */ UNK,
    /* 0x60 */ UNK,
    /* 0x61 */ UNK,
    /* 0x62 */ UNK,
    /* 0x63 */ UNK,
    /* 0x64 */ UNK,
    /* 0x65 */ UNK,
    /* 0x66 */ { Z80_BIT, Z80_B4, Z80_pIYd },
    /* 0x67 */ UNK,
    /* 0x68 */ UNK,
    /* 0x69 */ UNK,
    /* 0x6a */ UNK,
    /* 0x6b */ UNK,
    /* 0x6c */ UNK,
    /* 0x6d */ UNK,
    /* 0x6e */ { Z80_BIT, Z80_B5, Z80_pIYd },
    /* 0x6f */ UNK,
    /* 0x70 */ UNK,
    /* 0x71 */ UNK,
    /* 0x72 */ UNK,
    /* 0x73 */ UNK,
    /* 0x74 */ UNK,
    /* 0x75 */ UNK,
    /* 0x76 */ { Z80_BIT, Z80_B6, Z80_pIYd },
    /* 0x77 */ UNK,
    /* 0x78 */ UNK,
    /* 0x79 */ UNK,
    /* 0x7a */ UNK,
    /* 0x7b */ UNK,
    /* 0x7c */ UNK,
    /* 0x7d */ UNK,
    /* 0x7e */ { Z80_BIT, Z80_B7, Z80_pIYd },
    /* 0x7f */ UNK,
    /* 0x80 */ UNK,
    /* 0x81 */ UNK,
    /* 0x82 */ UNK,
    /* 0x83 */ UNK,
    /* 0x84 */ UNK,
    /* 0x85 */ UNK,
    /* 0x86 */ { Z80_RES, Z80_B0, Z80_pIYd },
    /* 0x87 */ UNK,
    /* 0x88 */ UNK,
    /* 0x89 */ UNK,
    /* 0x8a */ UNK,
    /* 0x8b */ UNK,
    /* 0x8c */ UNK,
    /* 0x8d */ UNK,
    /* 0x8e */ { Z80_RES, Z80_B1, Z80_pIYd },
    /* 0x8f */ UNK,
    /* 0x90 */ UNK,
    /* 0x91 */ UNK,
    /* 0x92 */ UNK,
    /* 0x93 */ UNK,
    /* 0x94 */ UNK,
    /* 0x95 */ UNK,
    /* 0x96 */ { Z80_RES, Z80_B2, Z80_pIYd },
    /* 0x97 */ UNK,
    /* 0x98 */ UNK,
    /* 0x99 */ UNK,
    /* 0x9a */ UNK,
    /* 0x9b */ UNK,
    /* 0x9c */ UNK,
    /* 0x9d */ UNK,
    /* 0x9e */ { Z80_RES, Z80_B3, Z80_pIYd },
    /* 0x9f */ UNK,
    /* 0xa0 */ UNK,
    /* 0xa1 */ UNK,
    /* 0xa2 */ UNK,
    /* 0xa3 */ UNK,
    /* 0xa4 */ UNK,
    /* 0xa5 */ UNK,
    /* 0xa6 */ { Z80_RES, Z80_B4, Z80_pIYd },
    /* 0xa7 */ UNK,
    /* 0xa8 */ UNK,
    /* 0xa9 */ UNK,
    /* 0xaa */ UNK,
    /* 0xab */ UNK,
    /* 0xac */ UNK,
    /* 0xad */ UNK,
    /* 0xae */ { Z80_RES, Z80_B5, Z80_pIYd },
    /* 0xaf */ UNK,
    /* 0xb0 */ UNK,
    /* 0xb1 */ UNK,
    /* 0xb2 */ UNK,
    /* 0xb3 */ UNK,
    /* 0xb4 */ UNK,
    /* 0xb5 */ UNK,
    /* 0xb6 */ { Z80_RES, Z80_B6, Z80_pIYd },
    /* 0xb7 */ UNK,
    /* 0xb8 */ UNK,
    /* 0xb9 */ UNK,
    /* 0xba */ UNK,
    /* 0xbb */ UNK,
    /* 0xbc */ UNK,
    /* 0xbd */ UNK,
    /* 0xbe */ { Z80_RES, Z80_B7, Z80_pIYd },
    /* 0xbf */ UNK,
    /* 0xc0 */ UNK,
    /* 0xc1 */ UNK,
    /* 0xc2 */ UNK,
    /* 0xc3 */ UNK,
    /* 0xc4 */ UNK,
    /* 0xc5 */ UNK,
    /* 0xc6 */ { Z80_SET, Z80_B0, Z80_pIYd },
    /* 0xc7 */ UNK,
    /* 0xc8 */ UNK,
    /* 0xc9 */ UNK,
    /* 0xca */ UNK,
    /* 0xcb */ UNK,
    /* 0xcc */ UNK,
    /* 0xcd */ UNK,
    /* 0xce */ { Z80_SET, Z80_B1, Z80_pIYd },
    /* 0xcf */ UNK,
    /* 0xd0 */ UNK,
    /* 0xd1 */ UNK,
    /* 0xd2 */ UNK,
    /* 0xd3 */ UNK,
    /* 0xd4 */ UNK,
    /* 0xd5 */ UNK,
    /* 0xd6 */ { Z80_SET, Z80_B2, Z80_pIYd },
    /* 0xd7 */ UNK,
    /* 0xd8 */ UNK,
    /* 0xd9 */ UNK,
    /* 0xda */ UNK,
    /* 0xdb */ UNK,
    /* 0xdc */ UNK,
    /* 0xdd */ UNK,
    /* 0xde */ { Z80_SET, Z80_B3, Z80_pIYd },
    /* 0xdf */ UNK,
    /* 0xe0 */ UNK,
    /* 0xe1 */ UNK,
    /* 0xe2 */ UNK,
    /* 0xe3 */ UNK,
    /* 0xe4 */ UNK,
    /* 0xe5 */ UNK,
    /* 0xe6 */ { Z80_SET, Z80_B4, Z80_pIYd },
    /* 0xe7 */ UNK,
    /* 0xe8 */ UNK,
    /* 0xe9 */ UNK,
    /* 0xea */ UNK,
    /* 0xeb */ UNK,
    /* 0xec */ UNK,
    /* 0xed */ UNK,
    /* 0xee */ { Z80_SET, Z80_B5, Z80_pIYd },
    /* 0xef */ UNK,
    /* 0xf0 */ UNK,
    /* 0xf1 */ UNK,
    /* 0xf2 */ UNK,
    /* 0xf3 */ UNK,
    /* 0xf4 */ UNK,
    /* 0xf5 */ UNK,
    /* 0xf6 */ { Z80_SET, Z80_B6, Z80_pIYd },
    /* 0xf7 */ UNK,
    /* 0xf8 */ UNK,
    /* 0xf9 */ UNK,
    /* 0xfa */ UNK,
    /* 0xfb */ UNK,
    /* 0xfc */ UNK,
    /* 0xfd */ UNK,
    /* 0xfe */ { Z80_SET, Z80_B7, Z80_pIYd },
    /* 0xff */ UNK
  };


static const Z80_InstId _insts_fd[256]=
  {
    /* 0x0 */  UNK,
    /* 0x1 */  UNK,
    /* 0x2 */  UNK,
    /* 0x3 */  UNK,
    /* 0x4 */  UNK,
    /* 0x5 */  UNK,
    /* 0x6 */  UNK,
    /* 0x7 */  UNK,
    /* 0x8 */  UNK,
    /* 0x9 */  { Z80_ADD, Z80_IY, Z80_BC },
    /* 0xa */  UNK,
    /* 0xb */  UNK,
    /* 0xc */  UNK,
    /* 0xd */  UNK,
    /* 0xe */  UNK,
    /* 0xf */  UNK,
    /* 0x10 */ UNK,
    /* 0x11 */ UNK,
    /* 0x12 */ UNK,
    /* 0x13 */ UNK,
    /* 0x14 */ UNK,
    /* 0x15 */ UNK,
    /* 0x16 */ UNK,
    /* 0x17 */ UNK,
    /* 0x18 */ UNK,
    /* 0x19 */ { Z80_ADD, Z80_IY, Z80_DE },
    /* 0x1a */ UNK,
    /* 0x1b */ UNK,
    /* 0x1c */ UNK,
    /* 0x1d */ UNK,
    /* 0x1e */ UNK,
    /* 0x1f */ UNK,
    /* 0x20 */ UNK,
    /* 0x21 */ { Z80_LD, Z80_IY, Z80_WORD },
    /* 0x22 */ { Z80_LD, Z80_ADDR, Z80_IY },
    /* 0x23 */ { Z80_INC, Z80_IY, Z80_NONE },
    /* 0x24 */ { Z80_INC, Z80_IYH, Z80_NONE },
    /* 0x25 */ { Z80_DEC, Z80_IYH, Z80_NONE },
    /* 0x26 */ { Z80_LD, Z80_IYH, Z80_BYTE },
    /* 0x27 */ UNK,
    /* 0x28 */ UNK,
    /* 0x29 */ { Z80_ADD, Z80_IY, Z80_IY },
    /* 0x2a */ { Z80_LD, Z80_IY, Z80_ADDR },
    /* 0x2b */ { Z80_DEC, Z80_IY, Z80_NONE },
    /* 0x2c */ { Z80_INC, Z80_IYL, Z80_NONE },
    /* 0x2d */ { Z80_DEC, Z80_IYL, Z80_NONE },
    /* 0x2e */ { Z80_LD, Z80_IYL, Z80_BYTE },
    /* 0x2f */ UNK,
    /* 0x30 */ UNK,
    /* 0x31 */ UNK,
    /* 0x32 */ UNK,
    /* 0x33 */ UNK,
    /* 0x34 */ { Z80_INC, Z80_pIYd, Z80_NONE },
    /* 0x35 */ { Z80_DEC, Z80_pIYd, Z80_NONE },
    /* 0x36 */ { Z80_LD, Z80_pIYd, Z80_BYTE },
    /* 0x37 */ UNK,
    /* 0x38 */ UNK,
    /* 0x39 */ { Z80_ADD, Z80_IY, Z80_SP },
    /* 0x3a */ UNK,
    /* 0x3b */ UNK,
    /* 0x3c */ UNK,
    /* 0x3d */ UNK,
    /* 0x3e */ UNK,
    /* 0x3f */ UNK,
    /* 0x40 */ UNK,
    /* 0x41 */ UNK,
    /* 0x42 */ UNK,
    /* 0x43 */ UNK,
    /* 0x44 */ { Z80_LD, Z80_B, Z80_IYH },
    /* 0x45 */ { Z80_LD, Z80_B, Z80_IYL },
    /* 0x46 */ { Z80_LD, Z80_B, Z80_pIYd },
    /* 0x47 */ UNK,
    /* 0x48 */ UNK,
    /* 0x49 */ UNK,
    /* 0x4a */ UNK,
    /* 0x4b */ UNK,
    /* 0x4c */ { Z80_LD, Z80_C, Z80_IYH },
    /* 0x4d */ { Z80_LD, Z80_C, Z80_IYL },
    /* 0x4e */ { Z80_LD, Z80_C, Z80_pIYd },
    /* 0x4f */ UNK,
    /* 0x50 */ UNK,
    /* 0x51 */ UNK,
    /* 0x52 */ UNK,
    /* 0x53 */ UNK,
    /* 0x54 */ { Z80_LD, Z80_D, Z80_IYH },
    /* 0x55 */ { Z80_LD, Z80_D, Z80_IYL },
    /* 0x56 */ { Z80_LD, Z80_D, Z80_pIYd },
    /* 0x57 */ UNK,
    /* 0x58 */ UNK,
    /* 0x59 */ UNK,
    /* 0x5a */ UNK,
    /* 0x5b */ UNK,
    /* 0x5c */ { Z80_LD, Z80_E, Z80_IYH },
    /* 0x5d */ { Z80_LD, Z80_E, Z80_IYL },
    /* 0x5e */ { Z80_LD, Z80_E, Z80_pIYd },
    /* 0x5f */ UNK,
    /* 0x60 */ { Z80_LD, Z80_IYH, Z80_B },
    /* 0x61 */ { Z80_LD, Z80_IYH, Z80_C },
    /* 0x62 */ { Z80_LD, Z80_IYH, Z80_D },
    /* 0x63 */ { Z80_LD, Z80_IYH, Z80_E },
    /* 0x64 */ UNK,
    /* 0x65 */ UNK,
    /* 0x66 */ { Z80_LD, Z80_H, Z80_pIYd },
    /* 0x67 */ { Z80_LD, Z80_IYH, Z80_A },
    /* 0x68 */ { Z80_LD, Z80_IYL, Z80_B },
    /* 0x69 */ { Z80_LD, Z80_IYL, Z80_C },
    /* 0x6a */ { Z80_LD, Z80_IYL, Z80_D },
    /* 0x6b */ { Z80_LD, Z80_IYL, Z80_E },
    /* 0x6c */ UNK,
    /* 0x6d */ UNK,
    /* 0x6e */ { Z80_LD, Z80_L, Z80_pIYd },
    /* 0x6f */ { Z80_LD, Z80_IYL, Z80_A },
    /* 0x70 */ { Z80_LD, Z80_pIYd, Z80_B },
    /* 0x71 */ { Z80_LD, Z80_pIYd, Z80_C },
    /* 0x72 */ { Z80_LD, Z80_pIYd, Z80_D },
    /* 0x73 */ { Z80_LD, Z80_pIYd, Z80_E },
    /* 0x74 */ { Z80_LD, Z80_pIYd, Z80_H },
    /* 0x75 */ { Z80_LD, Z80_pIYd, Z80_L },
    /* 0x76 */ UNK,
    /* 0x77 */ { Z80_LD, Z80_pIYd, Z80_A },
    /* 0x78 */ UNK,
    /* 0x79 */ UNK,
    /* 0x7a */ UNK,
    /* 0x7b */ UNK,
    /* 0x7c */ { Z80_LD, Z80_A, Z80_IYH },
    /* 0x7d */ { Z80_LD, Z80_A, Z80_IYL },
    /* 0x7e */ { Z80_LD, Z80_A, Z80_pIYd },
    /* 0x7f */ UNK,
    /* 0x80 */ UNK,
    /* 0x81 */ UNK,
    /* 0x82 */ UNK,
    /* 0x83 */ UNK,
    /* 0x84 */ UNK,
    /* 0x85 */ { Z80_ADD, Z80_A, Z80_IYL },
    /* 0x86 */ { Z80_ADD, Z80_A, Z80_pIYd },
    /* 0x87 */ UNK,
    /* 0x88 */ UNK,
    /* 0x89 */ UNK,
    /* 0x8a */ UNK,
    /* 0x8b */ UNK,
    /* 0x8c */ { Z80_ADC, Z80_A, Z80_IYH },
    /* 0x8d */ UNK,
    /* 0x8e */ { Z80_ADC, Z80_A, Z80_pIYd },
    /* 0x8f */ UNK,
    /* 0x90 */ UNK,
    /* 0x91 */ UNK,
    /* 0x92 */ UNK,
    /* 0x93 */ UNK,
    /* 0x94 */ { Z80_SUB, Z80_A, Z80_IYH },
    /* 0x95 */ { Z80_SUB, Z80_A, Z80_IYL },
    /* 0x96 */ { Z80_SUB, Z80_A, Z80_pIYd },
    /* 0x97 */ UNK,
    /* 0x98 */ UNK,
    /* 0x99 */ UNK,
    /* 0x9a */ UNK,
    /* 0x9b */ UNK,
    /* 0x9c */ UNK,
    /* 0x9d */ UNK,
    /* 0x9e */ { Z80_SBC, Z80_A, Z80_pIYd },
    /* 0x9f */ UNK,
    /* 0xa0 */ UNK,
    /* 0xa1 */ UNK,
    /* 0xa2 */ UNK,
    /* 0xa3 */ UNK,
    /* 0xa4 */ UNK,
    /* 0xa5 */ UNK,
    /* 0xa6 */ { Z80_AND, Z80_A, Z80_pIYd },
    /* 0xa7 */ UNK,
    /* 0xa8 */ UNK,
    /* 0xa9 */ UNK,
    /* 0xaa */ UNK,
    /* 0xab */ UNK,
    /* 0xac */ UNK,
    /* 0xad */ UNK,
    /* 0xae */ { Z80_XOR, Z80_A, Z80_pIYd },
    /* 0xaf */ UNK,
    /* 0xb0 */ UNK,
    /* 0xb1 */ UNK,
    /* 0xb2 */ UNK,
    /* 0xb3 */ UNK,
    /* 0xb4 */ { Z80_OR, Z80_A, Z80_IYH },
    /* 0xb5 */ { Z80_OR, Z80_A, Z80_IYL },
    /* 0xb6 */ { Z80_OR, Z80_A, Z80_pIYd },
    /* 0xb7 */ UNK,
    /* 0xb8 */ UNK,
    /* 0xb9 */ UNK,
    /* 0xba */ UNK,
    /* 0xbb */ UNK,
    /* 0xbc */ { Z80_CP, Z80_A, Z80_IYH },
    /* 0xbd */ { Z80_CP, Z80_A, Z80_IYL },
    /* 0xbe */ { Z80_CP, Z80_A, Z80_pIYd },
    /* 0xbf */ UNK,
    /* 0xc0 */ UNK,
    /* 0xc1 */ UNK,
    /* 0xc2 */ UNK,
    /* 0xc3 */ UNK,
    /* 0xc4 */ UNK,
    /* 0xc5 */ UNK,
    /* 0xc6 */ UNK,
    /* 0xc7 */ UNK,
    /* 0xc8 */ UNK,
    /* 0xc9 */ UNK,
    /* 0xca */ UNK,
    /* 0xcb */ UNK,
    /* 0xcc */ UNK,
    /* 0xcd */ UNK,
    /* 0xce */ UNK,
    /* 0xcf */ UNK,
    /* 0xd0 */ UNK,
    /* 0xd1 */ UNK,
    /* 0xd2 */ UNK,
    /* 0xd3 */ UNK,
    /* 0xd4 */ UNK,
    /* 0xd5 */ UNK,
    /* 0xd6 */ UNK,
    /* 0xd7 */ UNK,
    /* 0xd8 */ UNK,
    /* 0xd9 */ UNK,
    /* 0xda */ UNK,
    /* 0xdb */ UNK,
    /* 0xdc */ UNK,
    /* 0xdd */ UNK,
    /* 0xde */ UNK,
    /* 0xdf */ UNK,
    /* 0xe0 */ UNK,
    /* 0xe1 */ { Z80_POP, Z80_IY, Z80_NONE },
    /* 0xe2 */ UNK,
    /* 0xe3 */ { Z80_EX, Z80_pSP, Z80_IY },
    /* 0xe4 */ UNK,
    /* 0xe5 */ { Z80_PUSH, Z80_IY },
    /* 0xe6 */ UNK,
    /* 0xe7 */ UNK,
    /* 0xe8 */ UNK,
    /* 0xe9 */ { Z80_JP, Z80_pIY, Z80_NONE },
    /* 0xea */ UNK,
    /* 0xeb */ UNK,
    /* 0xec */ UNK,
    /* 0xed */ UNK,
    /* 0xee */ UNK,
    /* 0xef */ UNK,
    /* 0xf0 */ UNK,
    /* 0xf1 */ UNK,
    /* 0xf2 */ UNK,
    /* 0xf3 */ UNK,
    /* 0xf4 */ UNK,
    /* 0xf5 */ UNK,
    /* 0xf6 */ UNK,
    /* 0xf7 */ UNK,
    /* 0xf8 */ UNK,
    /* 0xf9 */ { Z80_LD, Z80_SP, Z80_IY },
    /* 0xfa */ UNK,
    /* 0xfb */ UNK,
    /* 0xfc */ UNK,
    /* 0xfd */ UNK,
    /* 0xfe */ UNK,
    /* 0xff */ UNK  
  };


static const Z80_InstId _insts[256]=
  {
    /* 0x00 */ { Z80_NOP, Z80_NONE, Z80_NONE },
    /* 0x01 */ { Z80_LD, Z80_BC, Z80_WORD },
    /* 0x02 */ { Z80_LD, Z80_pBC, Z80_A },
    /* 0x03 */ { Z80_INC, Z80_BC, Z80_NONE },
    /* 0x04 */ { Z80_INC, Z80_B, Z80_NONE },
    /* 0x05 */ { Z80_DEC, Z80_B, Z80_NONE },
    /* 0x06 */ { Z80_LD, Z80_B, Z80_BYTE },
    /* 0x07 */ { Z80_RLCA, Z80_NONE, Z80_NONE },
    /* 0x08 */ { Z80_EX, Z80_AF, Z80_AF2 },
    /* 0x09 */ { Z80_ADD, Z80_HL, Z80_BC },
    /* 0x0a */ { Z80_LD, Z80_A, Z80_pBC },
    /* 0x0b */ { Z80_DEC, Z80_BC, Z80_NONE },
    /* 0x0c */ { Z80_INC, Z80_C, Z80_NONE },
    /* 0x0d */ { Z80_DEC, Z80_C, Z80_NONE },
    /* 0x0e */ { Z80_LD, Z80_C, Z80_BYTE },
    /* 0x0f */ { Z80_RRCA, Z80_NONE, Z80_NONE },
    /* 0x10 */ { Z80_DJNZ, Z80_BRANCH, Z80_NONE },
    /* 0x11 */ { Z80_LD, Z80_DE, Z80_WORD },
    /* 0x12 */ { Z80_LD, Z80_pDE, Z80_A },
    /* 0x13 */ { Z80_INC, Z80_DE, Z80_NONE },
    /* 0x14 */ { Z80_INC, Z80_D, Z80_NONE },
    /* 0x15 */ { Z80_DEC, Z80_D, Z80_NONE },
    /* 0x16 */ { Z80_LD, Z80_D, Z80_BYTE },
    /* 0x17 */ { Z80_RLA, Z80_NONE, Z80_NONE },
    /* 0x18 */ { Z80_JR, Z80_BRANCH, Z80_NONE },
    /* 0x19 */ { Z80_ADD, Z80_HL, Z80_DE },
    /* 0x1a */ { Z80_LD, Z80_A, Z80_pDE },
    /* 0x1b */ { Z80_DEC, Z80_DE, Z80_NONE },
    /* 0x1c */ { Z80_INC, Z80_E, Z80_NONE },
    /* 0x1d */ { Z80_DEC, Z80_E, Z80_NONE },
    /* 0x1e */ { Z80_LD, Z80_E, Z80_BYTE },
    /* 0x1f */ { Z80_RRA, Z80_NONE, Z80_NONE },
    /* 0x20 */ { Z80_JR, Z80_F_NZ, Z80_BRANCH },
    /* 0x21 */ { Z80_LD, Z80_HL, Z80_WORD },
    /* 0x22 */ { Z80_LD, Z80_ADDR, Z80_HL },
    /* 0x23 */ { Z80_INC, Z80_HL, Z80_NONE },
    /* 0x24 */ { Z80_INC, Z80_H, Z80_NONE },
    /* 0x25 */ { Z80_DEC, Z80_H, Z80_NONE },
    /* 0x26 */ { Z80_LD, Z80_H, Z80_BYTE },
    /* 0x27 */ { Z80_DAA, Z80_NONE, Z80_NONE },
    /* 0x28 */ { Z80_JR, Z80_F_Z, Z80_BRANCH },
    /* 0x29 */ { Z80_ADD, Z80_HL, Z80_HL },
    /* 0x2a */ { Z80_LD, Z80_HL, Z80_ADDR },
    /* 0x2b */ { Z80_DEC, Z80_HL, Z80_NONE },
    /* 0x2c */ { Z80_INC, Z80_L, Z80_NONE },
    /* 0x2d */ { Z80_DEC, Z80_L, Z80_NONE },
    /* 0x2e */ { Z80_LD, Z80_L, Z80_BYTE },
    /* 0x2f */ { Z80_CPL, Z80_NONE, Z80_NONE },
    /* 0x30 */ { Z80_JR, Z80_F_NC, Z80_BRANCH },
    /* 0x31 */ { Z80_LD, Z80_SP, Z80_WORD },
    /* 0x32 */ { Z80_LD, Z80_ADDR, Z80_A },
    /* 0x33 */ { Z80_INC, Z80_SP, Z80_NONE },
    /* 0x34 */ { Z80_INC, Z80_pHL, Z80_NONE },
    /* 0x35 */ { Z80_DEC, Z80_pHL, Z80_NONE },
    /* 0x36 */ { Z80_LD, Z80_pHL, Z80_BYTE },
    /* 0x37 */ { Z80_SCF, Z80_NONE, Z80_NONE },
    /* 0x38 */ { Z80_JR, Z80_F_C, Z80_BRANCH },
    /* 0x39 */ { Z80_ADD, Z80_HL, Z80_SP },
    /* 0x3a */ { Z80_LD, Z80_A, Z80_ADDR },
    /* 0x3b */ { Z80_DEC, Z80_SP, Z80_NONE },
    /* 0x3c */ { Z80_INC, Z80_A, Z80_NONE },
    /* 0x3d */ { Z80_DEC, Z80_A, Z80_NONE },
    /* 0x3e */ { Z80_LD, Z80_A, Z80_BYTE },
    /* 0x3f */ { Z80_CCF, Z80_NONE, Z80_NONE },
    /* 0x40 */ { Z80_LD, Z80_B, Z80_B },
    /* 0x41 */ { Z80_LD, Z80_B, Z80_C },
    /* 0x42 */ { Z80_LD, Z80_B, Z80_D },
    /* 0x43 */ { Z80_LD, Z80_B, Z80_E },
    /* 0x44 */ { Z80_LD, Z80_B, Z80_H },
    /* 0x45 */ { Z80_LD, Z80_B, Z80_L },
    /* 0x46 */ { Z80_LD, Z80_B, Z80_pHL },
    /* 0x47 */ { Z80_LD, Z80_B, Z80_A },
    /* 0x48 */ { Z80_LD, Z80_C, Z80_B },
    /* 0x49 */ { Z80_LD, Z80_C, Z80_C },
    /* 0x4a */ { Z80_LD, Z80_C, Z80_D },
    /* 0x4b */ { Z80_LD, Z80_C, Z80_E },
    /* 0x4c */ { Z80_LD, Z80_C, Z80_H },
    /* 0x4d */ { Z80_LD, Z80_C, Z80_L },
    /* 0x4e */ { Z80_LD, Z80_C, Z80_pHL },
    /* 0x4f */ { Z80_LD, Z80_C, Z80_A },
    /* 0x50 */ { Z80_LD, Z80_D, Z80_B },
    /* 0x51 */ { Z80_LD, Z80_D, Z80_C },
    /* 0x52 */ { Z80_LD, Z80_D, Z80_D },
    /* 0x53 */ { Z80_LD, Z80_D, Z80_E },
    /* 0x54 */ { Z80_LD, Z80_D, Z80_H },
    /* 0x55 */ { Z80_LD, Z80_D, Z80_L },
    /* 0x56 */ { Z80_LD, Z80_D, Z80_pHL },
    /* 0x57 */ { Z80_LD, Z80_D, Z80_A },
    /* 0x58 */ { Z80_LD, Z80_E, Z80_B },
    /* 0x59 */ { Z80_LD, Z80_E, Z80_C },
    /* 0x5a */ { Z80_LD, Z80_E, Z80_D },
    /* 0x5b */ { Z80_LD, Z80_E, Z80_E },
    /* 0x5c */ { Z80_LD, Z80_E, Z80_H },
    /* 0x5d */ { Z80_LD, Z80_E, Z80_L },
    /* 0x5e */ { Z80_LD, Z80_E, Z80_pHL },
    /* 0x5f */ { Z80_LD, Z80_E, Z80_A },
    /* 0x60 */ { Z80_LD, Z80_H, Z80_B },
    /* 0x61 */ { Z80_LD, Z80_H, Z80_C },
    /* 0x62 */ { Z80_LD, Z80_H, Z80_D },
    /* 0x63 */ { Z80_LD, Z80_H, Z80_E },
    /* 0x64 */ { Z80_LD, Z80_H, Z80_H },
    /* 0x65 */ { Z80_LD, Z80_H, Z80_L },
    /* 0x66 */ { Z80_LD, Z80_H, Z80_pHL },
    /* 0x67 */ { Z80_LD, Z80_H, Z80_A },
    /* 0x68 */ { Z80_LD, Z80_L, Z80_B },
    /* 0x69 */ { Z80_LD, Z80_L, Z80_C },
    /* 0x6a */ { Z80_LD, Z80_L, Z80_D },
    /* 0x6b */ { Z80_LD, Z80_L, Z80_E },
    /* 0x6c */ { Z80_LD, Z80_L, Z80_H },
    /* 0x6d */ { Z80_LD, Z80_L, Z80_L },
    /* 0x6e */ { Z80_LD, Z80_L, Z80_pHL },
    /* 0x6f */ { Z80_LD, Z80_L, Z80_A },
    /* 0x70 */ { Z80_LD, Z80_pHL, Z80_B },
    /* 0x71 */ { Z80_LD, Z80_pHL, Z80_C },
    /* 0x72 */ { Z80_LD, Z80_pHL, Z80_D },
    /* 0x73 */ { Z80_LD, Z80_pHL, Z80_E },
    /* 0x74 */ { Z80_LD, Z80_pHL, Z80_H },
    /* 0x75 */ { Z80_LD, Z80_pHL, Z80_L },
    /* 0x76 */ { Z80_HALT, Z80_NONE, Z80_NONE },
    /* 0x77 */ { Z80_LD, Z80_pHL, Z80_A },
    /* 0x78 */ { Z80_LD, Z80_A, Z80_B },
    /* 0x79 */ { Z80_LD, Z80_A, Z80_C },
    /* 0x7a */ { Z80_LD, Z80_A, Z80_D },
    /* 0x7b */ { Z80_LD, Z80_A, Z80_E },
    /* 0x7c */ { Z80_LD, Z80_A, Z80_H },
    /* 0x7d */ { Z80_LD, Z80_A, Z80_L },
    /* 0x7e */ { Z80_LD, Z80_A, Z80_pHL },
    /* 0x7f */ { Z80_LD, Z80_A, Z80_A },
    /* 0x80 */ { Z80_ADD, Z80_A, Z80_B },
    /* 0x81 */ { Z80_ADD, Z80_A, Z80_C },
    /* 0x82 */ { Z80_ADD, Z80_A, Z80_D },
    /* 0x83 */ { Z80_ADD, Z80_A, Z80_E },
    /* 0x84 */ { Z80_ADD, Z80_A, Z80_H },
    /* 0x85 */ { Z80_ADD, Z80_A, Z80_L },
    /* 0x86 */ { Z80_ADD, Z80_A, Z80_pHL },
    /* 0x87 */ { Z80_ADD, Z80_A, Z80_A },
    /* 0x88 */ { Z80_ADC, Z80_A, Z80_B },
    /* 0x89 */ { Z80_ADC, Z80_A, Z80_C },
    /* 0x8a */ { Z80_ADC, Z80_A, Z80_D },
    /* 0x8b */ { Z80_ADC, Z80_A, Z80_E },
    /* 0x8c */ { Z80_ADC, Z80_A, Z80_H },
    /* 0x8d */ { Z80_ADC, Z80_A, Z80_L },
    /* 0x8e */ { Z80_ADC, Z80_A, Z80_pHL },
    /* 0x8f */ { Z80_ADC, Z80_A, Z80_A },
    /* 0x90 */ { Z80_SUB, Z80_A, Z80_B },
    /* 0x91 */ { Z80_SUB, Z80_A, Z80_C },
    /* 0x92 */ { Z80_SUB, Z80_A, Z80_D },
    /* 0x93 */ { Z80_SUB, Z80_A, Z80_E },
    /* 0x94 */ { Z80_SUB, Z80_A, Z80_H },
    /* 0x95 */ { Z80_SUB, Z80_A, Z80_L },
    /* 0x96 */ { Z80_SUB, Z80_A, Z80_pHL },
    /* 0x97 */ { Z80_SUB, Z80_A, Z80_A },
    /* 0x98 */ { Z80_SBC, Z80_A, Z80_B },
    /* 0x99 */ { Z80_SBC, Z80_A, Z80_C },
    /* 0x9a */ { Z80_SBC, Z80_A, Z80_D },
    /* 0x9b */ { Z80_SBC, Z80_A, Z80_E },
    /* 0x9c */ { Z80_SBC, Z80_A, Z80_H },
    /* 0x9d */ { Z80_SBC, Z80_A, Z80_L },
    /* 0x9e */ { Z80_SBC, Z80_A, Z80_pHL },
    /* 0x9f */ { Z80_SBC, Z80_A, Z80_A },
    /* 0xa0 */ { Z80_AND, Z80_A, Z80_B },
    /* 0xa1 */ { Z80_AND, Z80_A, Z80_C },
    /* 0xa2 */ { Z80_AND, Z80_A, Z80_D },
    /* 0xa3 */ { Z80_AND, Z80_A, Z80_E },
    /* 0xa4 */ { Z80_AND, Z80_A, Z80_H },
    /* 0xa5 */ { Z80_AND, Z80_A, Z80_L },
    /* 0xa6 */ { Z80_AND, Z80_A, Z80_pHL },
    /* 0xa7 */ { Z80_AND, Z80_A, Z80_A },
    /* 0xa8 */ { Z80_XOR, Z80_A, Z80_B },
    /* 0xa9 */ { Z80_XOR, Z80_A, Z80_C },
    /* 0xaa */ { Z80_XOR, Z80_A, Z80_D },
    /* 0xab */ { Z80_XOR, Z80_A, Z80_E },
    /* 0xac */ { Z80_XOR, Z80_A, Z80_H },
    /* 0xad */ { Z80_XOR, Z80_A, Z80_L },
    /* 0xae */ { Z80_XOR, Z80_A, Z80_pHL },
    /* 0xaf */ { Z80_XOR, Z80_A, Z80_A },
    /* 0xb0 */ { Z80_OR, Z80_A, Z80_B },
    /* 0xb1 */ { Z80_OR, Z80_A, Z80_C },
    /* 0xb2 */ { Z80_OR, Z80_A, Z80_D },
    /* 0xb3 */ { Z80_OR, Z80_A, Z80_E },
    /* 0xb4 */ { Z80_OR, Z80_A, Z80_H },
    /* 0xb5 */ { Z80_OR, Z80_A, Z80_L },
    /* 0xb6 */ { Z80_OR, Z80_A, Z80_pHL },
    /* 0xb7 */ { Z80_OR, Z80_A, Z80_A },
    /* 0xb8 */ { Z80_CP, Z80_A, Z80_B },
    /* 0xb9 */ { Z80_CP, Z80_A, Z80_C },
    /* 0xba */ { Z80_CP, Z80_A, Z80_D },
    /* 0xbb */ { Z80_CP, Z80_A, Z80_E },
    /* 0xbc */ { Z80_CP, Z80_A, Z80_H },
    /* 0xbd */ { Z80_CP, Z80_A, Z80_L },
    /* 0xbe */ { Z80_CP, Z80_A, Z80_pHL },
    /* 0xbf */ { Z80_CP, Z80_A, Z80_A },
    /* 0xc0 */ { Z80_RET, Z80_F_NZ, Z80_NONE },
    /* 0xc1 */ { Z80_POP, Z80_BC, Z80_NONE },
    /* 0xc2 */ { Z80_JP, Z80_F_NZ, Z80_WORD },
    /* 0xc3 */ { Z80_JP, Z80_WORD, Z80_NONE },
    /* 0xc4 */ { Z80_CALL, Z80_F_NZ, Z80_WORD },
    /* 0xc5 */ { Z80_PUSH, Z80_BC, Z80_NONE },
    /* 0xc6 */ { Z80_ADD, Z80_A, Z80_BYTE },
    /* 0xc7 */ { Z80_RST00, Z80_NONE, Z80_NONE },
    /* 0xc8 */ { Z80_RET, Z80_F_Z, Z80_NONE },
    /* 0xc9 */ { Z80_RET, Z80_NONE, Z80_NONE },
    /* 0xca */ { Z80_JP, Z80_F_Z, Z80_WORD },
    /* 0xcb */ UNK,
    /* 0xcc */ { Z80_CALL, Z80_F_Z, Z80_WORD },
    /* 0xcd */ { Z80_CALL, Z80_WORD, Z80_NONE },
    /* 0xce */ { Z80_ADC, Z80_A, Z80_BYTE },
    /* 0xcf */ { Z80_RST08, Z80_NONE, Z80_NONE },
    /* 0xd0 */ { Z80_RET, Z80_F_NC, Z80_NONE },
    /* 0xd1 */ { Z80_POP, Z80_DE, Z80_NONE },
    /* 0xd2 */ { Z80_JP, Z80_F_NC, Z80_WORD },
    /* 0xd3 */ { Z80_OUT, Z80_pBYTE, Z80_A },
    /* 0xd4 */ { Z80_CALL, Z80_F_NC, Z80_WORD },
    /* 0xd5 */ { Z80_PUSH, Z80_DE, Z80_NONE },
    /* 0xd6 */ { Z80_SUB, Z80_A, Z80_BYTE },
    /* 0xd7 */ { Z80_RST10, Z80_NONE, Z80_NONE },
    /* 0xd8 */ { Z80_RET, Z80_F_C, Z80_NONE },
    /* 0xd9 */ { Z80_EXX, Z80_NONE, Z80_NONE },
    /* 0xda */ { Z80_JP, Z80_F_C, Z80_WORD },
    /* 0xdb */ { Z80_IN, Z80_A, Z80_pBYTE },
    /* 0xdc */ { Z80_CALL, Z80_F_C, Z80_WORD },
    /* 0xdd */ UNK,
    /* 0xde */ { Z80_SBC, Z80_A, Z80_BYTE },
    /* 0xdf */ { Z80_RST18, Z80_NONE, Z80_NONE },
    /* 0xe0 */ { Z80_RET, Z80_F_PO, Z80_NONE },
    /* 0xe1 */ { Z80_POP, Z80_HL, Z80_NONE },
    /* 0xe2 */ { Z80_JP, Z80_F_PO, Z80_WORD },
    /* 0xe3 */ { Z80_EX, Z80_pSP, Z80_HL },
    /* 0xe4 */ { Z80_CALL, Z80_F_PO, Z80_WORD },
    /* 0xe5 */ { Z80_PUSH, Z80_HL, Z80_NONE },
    /* 0xe6 */ { Z80_AND, Z80_A, Z80_BYTE },
    /* 0xe7 */ { Z80_RST20, Z80_NONE, Z80_NONE },
    /* 0xe8 */ { Z80_RET, Z80_F_PE, Z80_NONE },
    /* 0xe9 */ { Z80_JP, Z80_pHL, Z80_NONE },
    /* 0xea */ { Z80_JP, Z80_F_PE, Z80_WORD },
    /* 0xeb */ { Z80_EX, Z80_DE, Z80_HL },
    /* 0xec */ { Z80_CALL, Z80_F_PE, Z80_WORD },
    /* 0xed */ UNK,
    /* 0xee */ { Z80_XOR, Z80_A, Z80_BYTE },
    /* 0xef */ { Z80_RST28, Z80_NONE, Z80_NONE },
    /* 0xf0 */ { Z80_RET, Z80_F_P, Z80_NONE },
    /* 0xf1 */ { Z80_POP, Z80_AF, Z80_NONE },
    /* 0xf2 */ { Z80_JP, Z80_F_P, Z80_WORD },
    /* 0xf3 */ { Z80_DI, Z80_NONE, Z80_NONE },
    /* 0xf4 */ { Z80_CALL, Z80_F_P, Z80_WORD },
    /* 0xf5 */ { Z80_PUSH, Z80_AF, Z80_NONE },
    /* 0xf6 */ { Z80_OR, Z80_A, Z80_BYTE },
    /* 0xf7 */ { Z80_RST30, Z80_NONE, Z80_NONE },
    /* 0xf8 */ { Z80_RET, Z80_F_M, Z80_NONE },
    /* 0xf9 */ { Z80_LD, Z80_SP, Z80_HL },
    /* 0xfa */ { Z80_JP, Z80_F_M, Z80_WORD },
    /* 0xfb */ { Z80_EI, Z80_NONE, Z80_NONE },
    /* 0xfc */ { Z80_CALL, Z80_F_M, Z80_WORD },
    /* 0xfd */ UNK,
    /* 0xfe */ { Z80_CP, Z80_A, Z80_BYTE },
    /* 0xff */ { Z80_RST38, Z80_NONE, Z80_NONE }
  };




/*********************/
/* FUNCIONS PRIVADES */
/*********************/

static Z80u16
get_extra_byte (
        	Z80u16         addr,
        	Z80_InstExtra *extra,
        	Z80_Inst      *inst
        	)
{
  
  inst->bytes[inst->nbytes++]= extra->byte= Z80_read ( addr++ );
  
  return addr;
  
} /* end get_extra_byte */


static Z80u16
get_extra_desp (
        	Z80u16         addr,
        	Z80_InstExtra *extra,
        	Z80_Inst      *inst
        	)
{
  
  inst->bytes[inst->nbytes]= Z80_read ( addr++ );
  extra->desp= (Z80s8) (inst->bytes[inst->nbytes++]);
  
  return addr;
  
} /* end get_extra_desp */


static Z80u16
get_extra_addr_word (
        	     Z80u16         addr,
        	     Z80_InstExtra *extra,
        	     Z80_Inst      *inst
        	     )
{
  
  extra->addr_word= inst->bytes[inst->nbytes++]= Z80_read ( addr++ );
  inst->bytes[inst->nbytes]= Z80_read ( addr++ );
  extra->addr_word|= ((Z80u16) inst->bytes[inst->nbytes++])<<8;
  
  return addr;
  
} /* end get_extra_addr_word */


static Z80u16
get_extra_branch (
        	  Z80u16         addr,
        	  Z80_InstExtra *extra,
        	  Z80_Inst      *inst
        	  )
{
  
  inst->bytes[inst->nbytes]= Z80_read ( addr++ );
  extra->branch.desp= (Z80s8) (inst->bytes[inst->nbytes++]);
  extra->branch.addr= addr + extra->branch.desp;
  
  return addr;
  
} /* end get_extra_branch */


static Z80u16
get_extra_op (
              Z80u16            addr,
              const Z80_OpType  op,
              Z80_InstExtra    *extra,
              Z80_Inst         *inst
              )
{
  
  switch ( op )
    {
    case Z80_pBYTE:
    case Z80_BYTE: return get_extra_byte ( addr, extra, inst );
    case Z80_pIXd:
    case Z80_pIYd: return get_extra_desp ( addr, extra, inst );
    case Z80_ADDR:
    case Z80_WORD: return get_extra_addr_word ( addr, extra, inst );
    case Z80_BRANCH: return get_extra_branch ( addr, extra, inst );
    default: break;
    }
  
  return addr;
  
} /* end get_extra_op */


static Z80u16
get_extra (
           Z80u16    addr,
           Z80_Inst *inst
           )
{
  
  addr= get_extra_op ( addr, inst->id.op1, &(inst->e1), inst );
  return get_extra_op ( addr, inst->id.op2, &(inst->e2), inst );
  
} /* end get_extra */


static Z80u16
decode_cb (
           Z80u16    addr,
           Z80_Inst *inst
           )
{
  
  Z80u8 opcode;
  
  
  opcode= inst->bytes[1]= Z80_read ( addr++ );
  inst->nbytes= 2;
  inst->id= _insts_cb[opcode];
  
  return get_extra ( addr, inst );
  
} /* end decode_cb */


static Z80u16
decode_ddcb (
             Z80u16    addr,
             Z80_Inst *inst
             )
{
  
  Z80u8 opcode;
  
  
  inst->bytes[2]= Z80_read ( addr++ );
  inst->e1.desp= (Z80s8) (inst->bytes[2]);
  opcode= inst->bytes[3]= Z80_read ( addr++ );
  inst->nbytes= 4;
  inst->id= _insts_ddcb[opcode];
  
  return addr;
  
} /* end decode_ddcb */


static Z80u16
decode_dd (
           Z80u16    addr,
           Z80_Inst *inst
           )
{
  
  Z80u8 opcode;
  
  
  opcode= inst->bytes[1]= Z80_read ( addr++ );
  if ( opcode == 0xcb ) return decode_ddcb ( addr, inst );
  else
    {
      inst->nbytes= 2;
      inst->id= _insts_dd[opcode];
      return get_extra ( addr, inst );
    }
  
} /* end decode_dd */


static Z80u16
decode_ed (
           Z80u16    addr,
           Z80_Inst *inst
           )
{
  
  Z80u8 opcode;
  
  
  opcode= inst->bytes[1]= Z80_read ( addr++ );
  inst->nbytes= 2;
  inst->id= _insts_ed[opcode];
  
  return get_extra ( addr, inst );
  
} /* end decode_ed */


static Z80u16
decode_fdcb (
             Z80u16    addr,
             Z80_Inst *inst
             )
{
  
  Z80u8 opcode;
  
  
  inst->bytes[2]= Z80_read ( addr++ );
  inst->e1.desp= (Z80s8) inst->bytes[2];
  opcode= inst->bytes[3]= Z80_read ( addr++ );
  inst->nbytes= 4;
  inst->id= _insts_fdcb[opcode];
  
  return addr;
  
} /* end decode_fdcb */


static Z80u16
decode_fd (
           Z80u16    addr,
           Z80_Inst *inst
           )
{
  
  Z80u8 opcode;
  
  
  opcode= inst->bytes[1]= Z80_read ( addr++ );
  if ( opcode == 0xcb ) return decode_fdcb ( addr, inst );
  else
    {
      inst->nbytes= 2;
      inst->id= _insts_fd[opcode];
      return get_extra ( addr, inst );
    }
  
} /* end decode_fd */




/**********************/
/* FUNCIONS PÚBLIQUES */
/**********************/

Z80u16
Z80_decode (
            Z80u16    addr,
            Z80_Inst *inst
            )
{
  
  Z80u8 opcode;
  
  
  opcode= inst->bytes[0]= Z80_read ( addr++ );
  switch ( opcode )
    {
    case 0xcb: return decode_cb ( addr, inst );
    case 0xdd: return decode_dd ( addr, inst );
    case 0xed: return decode_ed ( addr, inst );
    case 0xfd: return decode_fd ( addr, inst );
    default:
      inst->nbytes= 1;
      inst->id= _insts[opcode];
      return get_extra ( addr, inst );
    }
  
} /* end Z80_dis */
